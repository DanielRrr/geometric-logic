\documentclass[a4paper]{article}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{bussproofs}
\usepackage{mathtools}
\usepackage{verbatim}
\usepackage{dsfont}
\usepackage{mathabx}
\usepackage[all, 2cell]{xy}
\usepackage[all]{xy}
\usepackage{wasysym}
\usepackage{rotating}
\usepackage{geometry}
\usepackage{trfsigns}
\usepackage{cmll}
\usepackage{authblk}
\usepackage{hyperref}
\usepackage{cleveref}
\usepackage{lipsum}
\usepackage{extpfeil}
\usepackage{soul}
\usepackage{graphicx}

\newcommand\mapsfrom{\mathrel{\reflectbox{\ensuremath{\mapsto}}}}

\theoremstyle{defin}
\newtheorem{definition}{Definition}

\theoremstyle{theorem}
\newtheorem{theorem}{Theorem}

\theoremstyle{claim}
\newtheorem{claim}{Claim}

\theoremstyle{prop}
\newtheorem{prop}{Proposition}

\theoremstyle{lemma}
\newtheorem{lemma}{Lemma}

\theoremstyle{fact}
\newtheorem{fact}{Fact}

\theoremstyle{ex}
\newtheorem{ex}{Example}


\theoremstyle{col}
\newtheorem{col}{Corollary}

\let\strokeL\L
\DeclareRobustCommand{\L}{\ifmmode\mathbf{L}\else\strokeL\fi}

\author{Daniel Rogozin}
\date{}
\title{Notes on Geometric logic}

\begin{document}

\maketitle

\section{Locales, quantales and cover systems}

A frame is a complete lattice $\mathcal{L} = (L, \wedge, \bigvee)$ such that, for all $a \in L$ and $A \subseteq L$:
\begin{center}
$a \wedge \bigvee A = \bigvee \{ a \wedge b \: | \: b \in A \}$
\end{center}
A frame homeomorphism is a map between frames that preserves $0$, $1$, $\wedge$ and $\bigvee$. The ${\bf Frm}$ is the category of all frames and homeomorphisms, the category of locales ${\bf Loc}$ is said to be the opposite category of the category of frames.

The notion of a quantale generalises frames. A quantale $\mathcal{Q} = (Q, \cdot, \bigvee)$ is a complete lattice-ordered semigroup such that, for all $a \in Q$ and $A \subseteq Q$:
\begin{center}
$a \cdot \bigvee A = \bigvee \{ a \cdot b \: | \: b \in A \}$

$\bigvee A \cdot a = \bigvee \{ b \cdot a \: | \: b \in A \}$
\end{center}

\section{Sheaves, Sites and Grothendieck toposes}

Let $\mathcal{I} = (I, \theta)$ be a topological space. Consider $\theta$ as a poset. A {\emph presheaf} over $\mathcal{I}$ is a contravariant functor from $\theta$ to ${\bf Set}$.

The notion of a presheaf generalises essentially the following construction from set-theoretic topology. First of all, we discuss a set-theoretic examples without referring to topology. Consider an indexed family of disjoint sets:
\begin{center}
$\mathcal{A} = \{ A_i \: | \: i \in I \}$.
\end{center}
We can associate an obvious map $p : A \to I$ since for every $x \in \mathcal{A}$ there is a unique $i \in I$ such that $x \in A_i$. Take

\begin{center}
$p^{-1}(\{ i \}) = \{ x \: | \: p(x) = i\} = A_i$
\end{center}

Such $p^{-1}(\{ i \})$ is called the \emph{fibre} over $i$, the whole structure is a bundle of sets over the base space $I$, $\mathcal{A}$ is the stalk space (l'espace etale) of the bundle. More generally, we can extract the bundle from every map $p : A \to I$

A morphism of bundles $(A, I)$ and $(B, I)$ is a commutative triangle of the following form:

\xymatrix{
&&&&&& A \ar[rr]^f \ar[dr]_{p_1} && B \ar[dl]^{p_2}\\
&&&&&&& I
}

Topologically, a sheaf is a version of bundles for topological spaces. Let $\mathcal{I} = (I, \theta)$ be a topological space. A sheaf is a tuple $(\mathcal{A}, p)$, where $\mathcal{A}$ is a topological space and $p : A \to I$ is a continuous map, which is also a local homeomorphism, that is, every $x \in \mathcal{A}$ has an open neighbourhood, which mapped homeomorphically by $p$ onto $p(U)$ and $p(U)$ is open in $I$. The category of all sheaves of $I$ is sometimes called a spatial topos.

We can extract a presheaf from a sheaf $(A, f)$ as a contravariant functor $F_f : \theta \to {\bf Set}$ as
\begin{center}
$F_f(V) = \{ s : V \to A \: | \: \text{$s$ is continuous and $f \circ s = V \hookrightarrow I $}\}$
\end{center}

The category of presheafs over $I$, denoted as ${\bf PsC}(I)$, consists of presheafs as objects and natural transformations $\tau : F \Rightarrow G$, that is, a collection of functions $\tau_U : F(U) \to G(U)$ making this square commute whenever $U \subseteq V$

\xymatrix{
&&&&& F(V) \ar[d]_{F^V_U} \ar[rr]^{\tau_V} && G(V) \ar[d]^{G^V_U} \\
&&&&& F(U) \ar[rr]_{\tau_U} && G(U)
}

It is clear that ${\bf PsC}(I)$ is equivalent to ${\bf Set}^{\theta^{Op}}$.

Let $F : \theta \to {\bf Set}$ be a presheaf. Let $x \in X$ and let $U, V$ be open neighbourhoods of $x$.
Let $s \in F(U)$ and $t \in F(V)$. $S$ and $T$ are said to have the \emph{same germ} at $x$, whenever there exists an open set $W \subseteq U \cap V$ with $x \in W$ such that $s|W = t|W \in P(W)$. Having the same germ is an equivalence relation, and the \emph{germ} of $s$ in $x$ in an equivalence class of $s$ denoted as $germ_x s$.

The \emph{stalk} of $F$ in $x$ is the set of all germs of $x$
\begin{center}
$F_x = \{ germ_x s \: | \: s \in F(U), U \in \theta \}$
\end{center}

Let $X$ be an index set and $V$ an open set, an \emph{open cover} of $V$ is a collection of sets $\{ V_x\}_{x \in X}$ such that
\begin{center}
$V = \bigcup \limits_{x \in X} V_x$
\end{center}

Intuitively, a sheaf is a presheaf that preserves open covers.

A \emph{sheaf} is a presheaf $F$ satisfying the following two extra-principles. Let $V$ be an open set and $\{V_x
\}_{x \in X}$ an open cover, then:
\begin{enumerate}
\item Let $s, t \in F(V)$ be sections such that such that $s|_{V_x} = t|_{V_x}$ for $x \in X$, then $s = t$.
\item Let $\{ s_x \in F(V_x) \}_{x \in X}$ be a family of sections. If for all $x, y \in X$ we have $s_x|_{V_x \cap V_y} = s_y|_{V_x \cap V_y}$, then there exists a section $s \in F(V)$ such that $s|_{V_x} = s_x$ for all $x \in X$.
\end{enumerate}
Equivalently, we can reformulate the latter as that $F(V) = \varprojlim_{x \in X} F(V_x)$.
The category ${\bf Sh}(I)$ is a category of sheaves over $I$.

\subsection{Grothendieck topos}

The notion of a Grothendieck topos generalises the aforementioned topological constructions. We start with the definition of a site.

Let $\mathcal{C}$ be a locally small category. A \emph{pretopology} on $\mathcal{C}$ is an assignment of each $A \in {\bf Ob}(\mathcal{C})$ of a collection of arrows $\operatorname{Cov}(A)$ (covers of $A$, or covering sieves) with the following properties:
\begin{enumerate}
\item $\{ id_A : A \to A \} \in \operatorname{Cov}(A)$
\item If $\{ f_x : A_x \to A \: | \: x \in X \} \in \operatorname{Cov}(A)$ and for each $x \in X$ we have an $a_x$-cover
\begin{center}
$\{ f_y^x : A_y^x \to A_x \: | \: y \in Y_x \} \in \operatorname{Cov}(A_x)$
\end{center}
then
\begin{center}
$\{ f_x \circ f_y^x : A^x_y \to A \: | \: x \in X, y \in Y_x\} \in  \operatorname{Cov}(A)$
\end{center}
\item If $\{ f_x : A_x \to A \: | \: x \in X \} \in \operatorname{Cov}(A)$ and $g : B \to A$ and assume that for each $x \in X$ the pullback of $f_x$ along $g$ exists:

\xymatrix{
&&&&& B \times_A A_x \ar[r] \ar[d]_{g_x} & A_x \ar[d]^{f_x}\\
&&&&& B \ar[r]_{g} & A
}
then $\{ g_x : B \times_A A_x \to B \:| \: x \in X\} \in \operatorname{Cov}(B)$
\end{enumerate}

A \emph{site} is the pair $(\mathcal{C}, \operatorname{Cov})$ consisting of a category and a pretopology on it.

A Grothendieck topos is a site with extra-conditions that generalise the axioms of topological sheaves in terms of a pretopology. A presheaf of sets over a category $\mathcal{C}$ is a contravariant functor $F : \mathcal{C} \to {\bf Set}$

Let $\operatorname{Cov}$ be a pretopology on a category $\mathcal{C}$ and $\{ f_x : A_x \to A \: | \: x \in X \} \in \operatorname{Cov}(A)$. Let $x, y \in X$ and we have the pullback of $f_x$ and $f_y$

\xymatrix{
&&&&& A_x \times_A A_y \ar[r] \ar[d] & A_y \ar[d]^{f_y}\\
&&&&& A_x \ar[r]_{f_x} & A
}

If $F$ is a presheaf over $\mathcal{C}$, then we have arrows $F^x_y : F(A_x) \to F(A_x \times_A A_y)$ and $F^y_x : F(A_y) \to F(A_x \times_A A_y)$. Denote $F_x$ as the arrow $F(f_x) : F(A) \to F(A_x)$.



A presheaf $F$ is a sheaf, if for any cover $\{ f_x : A_x \to A \: | \: x \in X \} \in \operatorname{Cov}(A)$, then for all $x, y \in X$ such that for all $s_x \in F(A_x)$ and $s_y \in F(A_y)$ such that $F^x_y(s_x) = F^y_x(y)$, then there exists a unique $s \in F(A)$ such that $F_x(s) = s_x$ for $x \in X$.

${\bf Sh}(\operatorname{Cov})$ is the category of sheaves of the site $(\mathcal{C}, \operatorname{Cov})$. A Grothendieck topos is a category of sheaves of some site up to categorical equivalence.

Alternatively, one can define a Grothendieck topos in terms of a Grothendieck topology as follows. Define a sieve $S$
as family morphisms in a category $\mathcal{C}$ that behaves as a right ideal:

\begin{center}
$f \in S$ implies $f \circ g \in S$
\end{center}

If $S$ is a sieve on $C \in \operatorname{Ob}(\mathcal{C})$ and $h \in Hom(D, C)$ for any $D \in \operatorname{Ob}(\mathcal{C})$, then
\begin{center}
$h^*(S) = \{ g \: | \: cod(g) = D, g \circ h \in S \}$
\end{center}

A \emph{Grothendieck topology} on a category $\mathcal{C}$ is a function $J$ that maps every $C \in \operatorname{Ob}(\mathcal{C})$, denoted as $J(C)$ such that:
\begin{enumerate}
\item the maximal sieve $t_C = \{ f \: | \: cod(f) = C\} \in J(C)$
\item If $S \in J(C)$, then $h^*(S) \in J(D)$
\item If $S \in J(C)$ and $R$ is a sieve of $C$ such that $h^*(R) \in J(D)$ for all $h : D \to C$, then $R \in J(C)$
\end{enumerate}
Also any $J(C)$ is upward closed.

\subsection{Examples}

We start with some examples of a site.

Let $\mathcal{T}$ be a small category of topological spaces closed under finite limits and under taking open subspaces. Define $\operatorname{Cov}$ as:
\begin{center}
$\{ f_i : Y_i \to X \: | \: i \in I \}$ iff each $Y_i$ is an open subspace of $X$ and $\bigcup \limits_{i \in I} Y_i = X$
\end{center}

The first axiom holds obviously, the second axiom holds since $\mathcal{T}$ is closed under taking subspaces. The third axiom holds because of the closure under finite limits.

Let $H$ be a frame. One can define a pretopology on a frame by putting:
\begin{center}
$\{ a_i \: | \: i \in I \} \in \operatorname{Cov}(c)$ iff $c = \bigvee \limits_{i \in I} a_i$
\end{center}

\subsubsection{The Zariski site}

Let $f_1, \dots, f_m \in \mathbb{C}[x_1, \dots, x_n]$, the locus of $f_1, \dots, f_m$ is the set
\begin{center}
$V(f_1, \dots, f_m) = \{ (z_1, \dots, z_n) \in C^n \: | \: f_i(z_1, \dots, z_n) = 0, i = 1, \dots, m \}$
\end{center}
Such a locus is called a \emph{complex affine variety}. With every variety $V$ we can associate the following ideal in the polynomial ring $\mathbb{C}[x_1, \dots, x_n]$:
\begin{center}
$I_V = \{ f \in \mathbb{C}[x_1, \dots, x_n] \: | \: \forall \vec{z} \in V f(\vec{z}) = 0 \}$
\end{center}
Conversly, let $I$ be an ideal in the polynomial ring $\mathbb{C}[x_1, \dots, x_n]$, then we can define the variety
\begin{center}
$V_I = \{ (z_1, \dots, z_n) \in C^n \: | \: f(z_1, \dots, z_n) = 0, f \in I \} $
\end{center}
If $I = (f_1, \dots, f_m)$, then $V_I = V(f_1, \dots, f_m)$.

With every ideal $I$ we can associate its radical
\begin{center}
$\sqrt{I} = \bigcup \limits_{0 < r < \omega} \{ f \in \mathbb{C}[x_1, \dots, x_n] \: | \: f^r \in I \}$
\end{center}
According to the Hilbert Nullstellensatz, $V_J \neq V_I$ whenever $\sqrt{I} \neq \sqrt{J}$.

The maximal ideals in $\mathbb{C}[x_1, \dots, x_n]$ have the form $(x_1 - a_1, \dots, x_n - a_n)$, so the corresponding variety is merely the singleton $\{ (a_1, \dots, a_n) \}$, a minimal algebraic variety. A prime ideal $P$ (that is, $fg \in P$ implies $g \in P$) in $\mathbb{C}[x_1, \dots, x_n]$ is a radical ideal. The corresponding variety of $P$ is irreducible, that is, it cannot be represented as the union of a finite number of smaller ideals. Moreover, every radical ideal can be represented as the intersection of some finite number of prime ideals. Dually, every complex affine variety can be represented as the union of some finite number of irreducible varieties.

The \emph{Zariski topology} on $\mathbb{C}^n$ is a topology defined on irreducible varieties as a closed subbasis. An algebraic hypersufrace is the locus of a single polynomial $f(x_1, \dots, x_n) = 0$. The complements of hypersurfaces form the open subbasis for the Zariski topology. An example of a cover of $\mathbb{C}^n$ can be defined by $t$ polynomials $f_1, \dots, f_t \in \mathbb{C}[x_1, \dots, x_n]$ such that $f_1 + \dots + f_t = 1$. Their hypersurfaces have no common points, so their complements are an open cover of $\mathbb{C}^n$.

With the Zariski topology, we can associate a \emph{structure sheaf}. Consider a field $\mathbb{F} = \mathbb{C}(x_1, \dots, x_n)$ consisting of rational functions, where $g \neq 0$. A rational function $h$ is defined at $Q \in (a_1, \dots, a_n) \in \mathbb{C}^n$, whenever there is a Zariski open set $W$, an open neighbourhood of $Q$, such that $h$ has the form $f/g$ for some $f, g \in \mathbb{C}[x_1, \dots, x_n]$ such that $g(\vec{z}) \neq 0$ for all $\vec{z} \in W$. In other words, $h$ yields a function $W \to \mathbb{C}$.

Now let $U$ be an open set in the Zariski topology, define $\mathcal{O}(U)$ as
\begin{center}
$\mathcal{O}(U) = \{ h \in \mathbb{F} \: | \: \forall Q \in U \: \text{$h(Q)$ is defined} \}$
\end{center}
The set $\mathcal{O}(U)$ is a ring, a moreover, a subring of a field $\mathbb{F}$ whenever $U$ is non-empty. $\mathcal{O}$ is also a contravariant functor (if we consider the Zariski topology on $\mathbb{C}$ as a category). Given $U \subseteq U'$, then $\mathcal{O}(U') \to \mathcal{O}(U)$ is a ring homomorphism that restricts each $h \in \mathcal{O}(U')$ to points of $U$. That is, $\mathcal{O}$ is a presheaf of rings for the Zariski topology on $\mathbb{C}^n$. It is also can be showed that $\mathcal{O}$ is a sheaf.

The stalk of $\mathcal{O}$ at a point $p \in \mathbb{C}^n$ consists of germs of all those rational functions defined in some open neighbourhood of $p$. Such a stalk is a ring with a unique maximal proper ideal, the ideal of all those germs that vanish at $p$. A \emph{local ring} is a ring of such form.

More generally, we consider the category of all affine varieties of $V \subseteq \mathbb{C}^n$ (for various $n \geq 0$), where morphisms $\phi : V \to W$ are defined as follows. Clearly $V = V(I)$ and $W = V(I')$ for some ideals $I$ and $I'$. $\phi$ is a function defined by an $m$-tuple $\phi = (h_1, \dots, h_m)$ of rational functions of $x_1, \dots, x_n$ such that each $h_i$ is defined at every point of $V$ and $(h_1, \dots, h_m)$ as a function $V \to \mathbb{C}^m$ maps $V$ into $W$.

This category can be equipped with the open cover topology, which is the Grothedieck topology defined by covering families of Zariski open sets.

This construction can be generalised as the Zariski site over a commutative ring $K$.

Let $K$ be a commutative ring with unit, define a ring $K[a^{-1}]$ of quotients for $a \in K$ that extends $K$ with fractions $b/a^n$ for each $b \in K$ and $n < \omega$.

As above, one can define the $n$-dimensional affine space $K^n$. Let $I$ be an ideal in the polynomial ring $K[x_1, \dots, x_n]$, we can define the variety $V_I$ defined similarly to the complex case. Generally, the Nullstellensatz is not the case for an abstract $K[x_1, \dots, x_n]$, so we shall work with quotient rings $K[x_1, \dots, x_n]/I$. Let $f_1, \dots, f_m \in K[x_1, \dots, x_n]$, the \emph{finitely presented $K$-algebra} is the quotient ring $K[x_1, \dots, x_n]/(f_1, \dots, f_m)$. $(K - Alg)_{fp}$ is the category all finitely presented $K$-algebra. There is a contravariant adjointness between $(K - Alg)_{fp}$ and the corresponding varieties.

\section{Kripke-Joyal semantics and quantifiers via adjoint functors}

\section{Internal logic}

\section{Geometric morphisms}

\section{Geometric logic}

\section{Kripke-Joyal semantics for quantales and non-commutative geometric theories}

\end{document}
