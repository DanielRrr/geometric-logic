\documentclass[a4paper]{article}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{bussproofs}
\usepackage{mathtools}
\usepackage{verbatim}
\usepackage{dsfont}
\usepackage{mathabx}
\usepackage[all, 2cell]{xy}
\usepackage[all]{xy}
\usepackage{wasysym}
\usepackage{rotating}
\usepackage{geometry}
\usepackage{trfsigns}
\usepackage{cmll}
\usepackage{authblk}
\usepackage{hyperref}
\usepackage{cleveref}
\usepackage{lipsum}
\usepackage{extpfeil}
\usepackage{soul}
\usepackage{graphicx}

\newcommand\mapsfrom{\mathrel{\reflectbox{\ensuremath{\mapsto}}}}

\theoremstyle{defin}
\newtheorem{definition}{Definition}

\theoremstyle{theorem}
\newtheorem{theorem}{Theorem}

\theoremstyle{claim}
\newtheorem{claim}{Claim}

\theoremstyle{prop}
\newtheorem{prop}{Proposition}

\theoremstyle{lemma}
\newtheorem{lemma}{Lemma}

\theoremstyle{fact}
\newtheorem{fact}{Fact}

\theoremstyle{ex}
\newtheorem{ex}{Example}


\theoremstyle{col}
\newtheorem{col}{Corollary}

\let\strokeL\L
\DeclareRobustCommand{\L}{\ifmmode\mathbf{L}\else\strokeL\fi}

\author{Daniel Rogozin}
\date{}
\title{Notes on Geometric logic}

\setcounter{section}{-1}
\begin{document}

\maketitle

\tableofcontents

\newpage

\nocite{*}

\section{Preliminaries}

\subsection{(co)Limits}

Let $\mathcal{C}$ be a category and $\mathcal{J}$ a small category. A \emph{diagram} $D$ is a functor $D : \mathcal{J} \to \mathcal{C}$, that is, informally, a diagram is a $\mathcal{J}$-indexed collection of $\mathcal{C}$-objects and some morphisms between them. A \emph{cone} for diagram $D$ consists of a $\mathcal{C}$-object $C$ with a $C$-arrow $f_i : C \to D(i)$ for $i \in \operatorname{Ob}(\mathcal{J})$ such that the following triangle commutes, for each $i, j \in \operatorname{Ob}(\mathcal{J})$:

\centerline{
\xymatrix{
D(i) \ar[rr]^g && D(j) \\
& C \ar[ul]^{f_i} \ar[ur]_{f_j}
}
}
For $D$-cones we will use notation $\{f_i : C \to D(i) \}$

A \emph{limit} for a diagram $D$ is a $D$-cone $\{f_i : C \to D(i) \}$ such that for any other $D$-cone $\{f_i' : C' \to D(i) \}$ there exists a unique arrow $f : C' \to C$ making the following triangle commute for every $i \in \operatorname{Ob}(\mathcal{J})$:

\centerline{
\xymatrix{
& D(i) \\
C' \ar[ur]^{f_i'} \ar[rr]_{\exists! f} && C \ar[ul]_{f_i}
}
}

By dualisation one can define co-cone and co-limits. A \emph{co-cone} for diagram $D$ consists of a $\mathcal{C}$-object $C$ with a $C$-arrow $f_i : D(i) \to C$ for $i \in \operatorname{Ob}(\mathcal{J})$ such that the following triangle commutes, for each $i, j \in \operatorname{Ob}(\mathcal{J})$:

\centerline{
\xymatrix{
D(i) \ar[dr]_{f_i} \ar[rr]^g && D(j) \ar[dl]^{f_j} \\
& C
}
}

A co-limit is a co-cone $\{ f_i : D(i) \to C \}$ such that for any other co-cone $\{ f_i : D(i) \to C' \}$ there exists a unique arrow $f : C \to C'$ making the following triangle commute for each $i \in \operatorname{Ob}(\mathcal{J})$:
\centerline{
\xymatrix{
& D(i) \ar[dr]_{f_i} \ar[dl]^{f_i'} \\
C \ar[rr]_{\exists ! f} && C'
}
}

A category is \emph{complete} (\emph{co-complete}), if every diagram has a limit (co-limit). We also call finitely complete categories \emph{Cartesian}.

\subsection{(co)equalisers}

Let $\mathcal{C}$ be a category, $A, B \in \operatorname{Ob}(\mathcal{C})$, $f, g : A \to B$. An arrow $i : E \to A$ is an equaliser of $f$ and $g$ if
\begin{enumerate}
\item $f \circ i = g \circ i$
\item If one has $h : C \to A$ with $f \circ h = g \circ h$, there exists a unique $k : C \to E$ such that $i \circ k = h$, in other words, the following diagram commutes

\centerline{
\xymatrix{
E \ar[rr]^i && A \ar@<1ex>[rr]^f \ar@<-1ex>[rr]_g && B \\
& C \ar@{-->}[ul]^{\exists ! k} \ar[ur]_{h}
}
}
\end{enumerate}

The simplest example of an equaliser is an injection $i : E \hookrightarrow A$ in ${\bf Set}$,
where $f, g : A \to B$ and $E = \{ x \in A \: | \: f(x) = g(x) \}$.

\begin{lemma}
Every equaliser is monic.
\end{lemma}

\begin{proof}
Suppose $i$ equalises $f$ and $g$. Let $j, l : C \to E$ and $i \circ j = i \circ l$. Let $h : C \to A$ be $i \circ j$. Then

\begin{center}
$f \circ h = f \circ (i \circ j) = (f \circ i) \circ j = (g \circ i) \circ j = g \circ h$
\end{center}

then there exists a unique $k$ with $i \circ k = h$, but $i \circ j = h$, so $k = j$. But also $i \circ l = i \circ j = h$, so $k = l$. Thus $j = l$.
\end{proof}

In terms of limits, an equaliser can be described as the limit of the following diagram:
\centerline{
\xymatrix{
A \ar@<1ex>[rr]^f \ar@<-1ex>[rr]_g && B
}}

By dualisation, we also have co-equalisers that can be defined as the co-limit of the aforementioned diagram. The explicit definition is the following.

A $\mathcal{C}$-arrow $q : B \to E$ is a co-equaliser of a pair $f, g : A \to B$ such that:
\begin{enumerate}
\item $q \circ f = q \circ g$
\item If $h : B \to C$ such that $h \circ f = h \circ g$, then there exists a unique $k : E \to C$ such that

\centerline{
\xymatrix{
A \ar@<1ex>[rr]^f \ar@<-1ex>[rr]_g && B \ar[ddrr]_{h} \ar[rr]^q && E \ar@{-->}[dd]^{\exists! k}\\
\\
&&&& C
}}
\end{enumerate}

\begin{lemma}
Every co-equialiser is epic.
\end{lemma}

\subsection{Pullbacks and pushouts}

A pullback is a limit of the following diagram:

\centerline{
\xymatrix{
&   B \ar[d]^g  \\
A \ar[r]_f & C
}}

Explicitly, a pullback of a pair of arrows $f : A \to C$ and $g : B \to C$ is a pair $f' : D \to B$ and $g' : D \to A$ such that:
\begin{enumerate}
\item $f \circ g' = g \circ f'$
\item whenever one has $h : E \to A$ and $j : E \to B$ such that $f \circ h = g \circ j$, then there exists a unique $k : E \to D$ making the following diagram commute:

\centerline{
\xymatrix{
E \ar@/_/[dddr]_h \ar@{-->}[dr]_{\exists! k} \ar@/^/[drrr]^j \\
& D \ar[dd]_{g'} \ar[rr]^{f'} && B \ar[dd]^{g} \\
\\
& A \ar[rr]_{f} && C
}}

In the category of sets the pullback of two functions $f : A \to C$ and $g : B \to C$ is defined by
\begin{center}
$A \times_C B = \{ (x, y) \in A \times B \: | \: f(x) = g(x) \}$
\end{center}
so the following square is a pullback

\centerline{
\xymatrix{
A \times_C B \ar[r]^{\pi_2} \ar[d]_{\pi_1} & B \ar[d]_g \\
A \ar[r]_{f} & C
}
}
\end{enumerate}

Let $f : G \to H$ be a group homomorphism and $\operatorname{Ker}(f) = \{ x \: | \: f(x) = e \}$ the kernel of $f$. Then the following square is a pullback:

\centerline{
\xymatrix{
\operatorname{Ker}(f) \: \ar@{^{(}->}[r] \ar[d]_{!} & G \ar[d]^f \\
\{ e \} \ar[r]_{!} & H
}
}

Dually, a pushout is a co-limit of the following diagram:

\centerline{
\xymatrix{
A \ar[r]^{g} \ar[d]_f & C \\
B
}
}

\subsection{Yoneda lemma and representable functors}

Let $\mathcal{C}$, $\mathcal{D}$ be locally small categories and ${\bf F} : \mathcal{C} \to \mathcal{D}$ a functor.
Then we have maps:
\begin{center}
${\bf F}_{X, Y} : \operatorname{Hom}_{\mathcal{C}}(X, Y) \to Hom_{\mathcal{D}}({\bf F} X, {\bf F} Y)$
\end{center}

${\bf F}$ is said to be \emph{full} if $F_{X, Y}$ is injective. ${\bf F}$ is faithful, whenever ${\bf F}_{X, Y}$ is onto. A functor ${\bf F}$ is an \emph{embedding} if it is full, faithful and injective on objects.

A functor ${\bf F} : \mathcal{C} \to {\bf Set}$ is \emph{representable} if it is naturally isomorphic to $\operatorname{Hom}_{C}(A, \underline{\:\:\:})$

Let $\mathcal{C}$ be a locally small category, the \emph{Yoneda embedding} is the functor ${\bf y} : \mathcal{C} \to {\bf Set}^{\mathcal{C}}$ mapping $C \in \operatorname{Ob}(\mathcal{C})$ to the contravariant representable functor
\begin{center}
${\bf y} C = \operatorname{Hom}_{\mathcal{C}}(\underline{\:\:\:}, C)$
\end{center}
and mapping $f : C \to D$ to the natural transformation
\begin{center}
${\bf y} f = \operatorname{Hom}_{\mathcal{C}}(\underline{\:\:\:}, f) : \operatorname{Hom}_{\mathcal{C}}(\underline{\:\:\:}, C) \Rightarrow \operatorname{Hom}_{\mathcal{C}}(\underline{\:\:\:}, D)$
\end{center}

\begin{lemma} [Yoneda lemma]

Let $\mathcal{C}$ be a locally small category. For any object $C \in \operatorname{Ob}(\mathcal{C})$ and a contravariant functor ${\bf F} \in {\bf Set}^{\mathcal{C}^{op}}$, there is an isomorphism

\begin{center}
${\bf F} C \cong \operatorname{Hom}({\bf y}C, {\bf F})$
\end{center}
which is natural in both ${\bf F}$ and $C$, that is, the following diagrams commute

\centerline{
\xymatrix{
\operatorname{Hom}({\bf y}C, {\bf F}) \ar[rr]^{\cong} \ar[d]_{\operatorname{Hom}({\bf y}C, \eta)} && {\bf F} C \ar[d]^{\eta_C} \\
\operatorname{Hom}({\bf y}C, {\bf G}) \ar[rr]_{\cong} && {\bf G} C
}
}
\centerline{
\xymatrix{
C \ar[d]_{f} & \operatorname{Hom}({\bf y}C, {\bf F}) \ar[rr]^{\cong} && {\bf F} C\\
D            & \operatorname{Hom}({\bf y}D, {\bf F}) \ar[u]^{\operatorname{Hom}({\bf y}f, {\bf F})} \ar[rr]_{\cong} && {\bf F} D \ar[u]_{{\bf F} f}
}
}
\end{lemma}

\begin{proof}

To establish the isomorphism
\begin{center}
$\eta_{C, {\bf F}} : \operatorname{Hom}({\bf y}C, {\bf F}) \to {\bf F} C$
\end{center}
take $\vartheta : {\bf y}C \Rightarrow {\bf F}$ and put
\begin{center}
$\eta_{C, {\bf F}}(\vartheta) = \vartheta_{C}(id_C)$
\end{center}
the latter also will be denoted as $x_{\vartheta}$. Here $\vartheta_{C} : \operatorname{Hom}_{\mathcal{C}}(C,C) \to {\bf F}C$.

Conversly, take any $a \in {\bf F}C$ and define the natural transformation $\vartheta_a : {\bf y} C \Rightarrow {\bf F}$. Let $C' \in \operatorname{Ob}(\mathcal{C})$, define the component:
\begin{center}
$(\vartheta_a)_{C'} : \operatorname{Hom}_{\mathcal{C}}(C,C') \to {\bf F}C'$
\end{center}
by setting for $h : C' \to C$
\begin{center}
$(\vartheta_a)_{C'}(h) = {\bf F}(h)(a)$
\end{center}

\begin{claim}
$\vartheta_a$ is a natural. That is, for any $f : C'' \to C'$, the following square commutes.

\centerline{
\xymatrix{
\operatorname{Hom}_{\mathcal{C}}(C'', C) \ar[rr]^{(\vartheta_a)_{C''}} && {\bf F}C'' \\
\operatorname{Hom}_{\mathcal{C}}(C', C) \ar[rr]_{(\vartheta_a)_{C'}} \ar[u]^{\operatorname{Hom}_{\mathcal{C}}(f, C)} && {\bf F}C' \ar[u]_{{\bf F}f}
}}
\end{claim}
\begin{proof}
Take any $h \in {\bf y}C(C')$, then
\begin{center}
$(\vartheta_a)_{C''} \circ \operatorname{Hom}_{\mathcal{C}}(f, C)(h) = (\vartheta_a)_{C''}(h \circ f) = {\bf F}(h \circ f)(a) = {\bf F}(f) \circ {\bf F}(h)(a) = {\bf F}(f) \circ (\vartheta_a)_{C'} (h)$
\end{center}
\end{proof}

\begin{claim}
$\vartheta_a$ and $x_{\eta}$ are mutally inverse.
\end{claim}
\begin{proof}
Given $\vartheta : {\bf y}C \Rightarrow {\bf F}$, let us calculate $\vartheta_{x_{\vartheta}}$. From the definitions one has for any $h : C' \to C$
\begin{center}
$(\vartheta_{x_{\vartheta}})_{C'}(h) = {\bf F}(h)(\vartheta_C(id_C))$
\end{center}

$\vartheta$ is natural, so the following commutes

\centerline{
\xymatrix{
{\bf y}C(C) \ar[d]_{{\bf y}C(h)} \ar[r]^{\vartheta_C} & {\bf F}C \ar[d]^{{\bf F}h}\\
{\bf y}C(C') \ar[r]_{\vartheta_{C'}} & {\bf F}C'
}
}
so
\begin{center}
$(\vartheta_{x_{\vartheta}})_{C'}(h) = {\bf F}(h)(\vartheta_C(id_C)) = \vartheta_{C'} \circ {\bf y}C(h)(id_C) = \vartheta_{C'}$
\end{center}
Thus $\vartheta_{x_{\vartheta}} = \vartheta$


For $a \in {\bf F}C$ one has
\begin{center}
$x_{\vartheta_{a}} = (\vartheta_a)_C(id_C) = {\bf F}(id_C)(a) = 1_{{\bf F} C}(a) = a$
\end{center}

All things considered, $\operatorname{Hom}({\bf y}C, {\bf F}) \cong {\bf F}C$
\end{proof}

\begin{claim}
Let $\phi : {\bf F} \Rightarrow {\bf F}'$ be a natural transformation, then the following square commutes

\centerline{
\xymatrix{
({\bf y} C, {\bf F}) \ar[d]_{({\bf y}C, \phi)}  \ar[r]^{\eta_{C, {\bf F}}} & {\bf F} C \ar[d]^{\phi_C} \\
({\bf y} C, {\bf F}')  \ar[r]_{\eta_{C, {\bf F}'}} & {\bf F}'C
}
}
\end{claim}

\begin{proof}
Take $x_{\vartheta}$, then

\begin{center}
$\phi_C(x_{\vartheta}) = \phi_C(\vartheta_C(id_C)) = (\phi \vartheta)_C(id_C) = \eta_{C, {\bf F}'}(({\bf y}C, \phi)(\vartheta))$
\end{center}
\end{proof}

We omit the proof of naturality in $C$ and ${\bf F}$.

\end{proof}

\begin{theorem}
The Yoneda embedding is fully faithful.
\end{theorem}

\subsection{Monoidal categories}

A \emph{monoidal category} (\emph{tensor}) is a structure $(\mathcal{C}, \otimes, {\bf I}, \alpha, \lambda, \rho)$, where:
\begin{itemize}
\item $\mathcal{C}$ is a category
\item $\otimes : \mathcal{C} \times \mathcal{C} \to \mathcal{C}$ is a bifunctor (tensor product)
\item $\alpha$, $\lambda$ and $\rho$ are natural isomorphisms:

\begin{center}
$\alpha_{A,B,C} : A \otimes (B \otimes C) \to (A \otimes B) \otimes C$

$\lambda_A : {\bf I} \otimes A \to A$

$\rho_A : A \otimes {\bf I} \to A$
\end{center}

such that $\lambda_{\bf I} = \rho_{\bf I}$ and the following diagrams commute (MacLane pentagon and triangle identity):

\vspace{\baselineskip}

\centerline{
\xymatrix{
& (A \otimes B) \otimes (C \otimes D) \ar[dr]^{\alpha} \\
A \otimes (B \otimes (C \otimes D)) \ar[ur]^{\alpha} \ar[d]_{id \otimes \alpha} && ((A \otimes B) \otimes C) \otimes D \\
A \otimes ((B \otimes C) \otimes D) \ar[rr]_{\alpha} && (A \otimes (B \otimes C)) \otimes D \ar[u]_{\alpha \otimes id}
}
}

\centerline{
\xymatrix{
A \otimes ({\bf I} \otimes B) \ar[rr]^{\alpha} \ar[dr]_{id \otimes \lambda} && (A \otimes {\bf I}) \otimes B \ar[dl]^{\rho \otimes id} \\
& A \otimes B
}
}
\end{itemize}

A category is called \emph{monoidal cocomplete} if section functors $\underline{ } \otimes B : \mathcal{C} \to \mathcal{C}$ and $A \otimes \underline{ }: \mathcal{C} \to \mathcal{C}$ are cocontinuous. In particular, we are interested in the following property.

Assume that $\mathcal{C}$ has all small coproducts. Suppose that for every collection $\{ A \}_{i \in J}$ and for any $B \in \operatorname{Ob}(\mathcal{C})$ one has the following isomorphisms:
\begin{center}
$q_1 : B \otimes (\coprod \limits_{i \in J} A_i) \cong \coprod \limits_{i \in J} (B \otimes A_i)$

$q_2 : (\coprod \limits_{i \in J} A_i) \otimes B \cong \coprod \limits_{i \in J} (A_i \otimes B)$
\end{center}

Then a structure $(\mathcal{C}, q_1, q_2)$ is called a \emph{Mulvey} category that one can thought as a categorical generalisation of unital quantales.

\section{Elementary topoi}

\subsection{Subobjects}

Let $A, B \in \operatorname{Ob}(\mathcal{C})$. $A$ is said to be a subobject of $B$ iff there exists a monic arrow $h : A \hookrightarrow B$. The inclusion relation on objects is defined by ``inclusion'' on monic arrows.

Let $f : A \hookrightarrow D$ and $g : B \hookrightarrow D$, then $f \subseteq g$ iff there exists an arrow $h : A \to B$ making this trianlge commute:

\centerline{
\xymatrix{
B \ar@{^{(}->}[dr]^{g} \\
& D \\
A \ar[uu]^{h} \ar@{^{(}->}[ur]_{f}
}}
that is, $f = g \circ h$

\begin{prop}
Such an $h$ is monic.
\end{prop}

\begin{prop}
$f \subseteq f$.
\end{prop}

\begin{proof}
The following triangle obviously commutes:

\centerline{
\xymatrix{
A \ar@{^{(}->}[dr]^{f} \\
& D \\
A \ar[uu]^{{\bf id}_A} \ar@{^{(}->}[ur]_{f}
}}
\end{proof}

\begin{prop}
$f \subseteq g$ and $g \subseteq k$ imply $f \subseteq k$.
\end{prop}

\begin{proof}
The following triangle commutes:

\centerline{
\xymatrix{
C \ar@{^{(}->}[dr]^{k} \\
B \ar[u]^i \: \ar@{^{(}->}[r]_{g} & D \\
A \ar[u]^h \ar@{^{(}->}[ur]_{f}
}}
Because of obvious calculations:
\begin{center}
$k \circ i \circ h = k \circ (i \circ h) = k \circ g = f$
\end{center}
\end{proof}

We also say that $f \simeq g$, whenever $f \subseteq g$ and $g \subseteq f$. In such case we shall identify them and omit metamathematical nitpicking.

Assume that a category $\mathcal{C}$ has a terminal object ${\bf 1}$, an arrow $x : {\bf 1} \to A$ is called an \emph{element} of $\mathcal{A}$.

\subsection{Subobject classification}

Let $\mathcal{C}$ be a category with a terminal object ${\bf 1}$. A \emph{subobject classifier} for $\mathcal{C}$ is an object $\Omega$ with an arrow $\top : {\bf 1} \to \Omega$ such that for each $f : A \hookrightarrow D$ there exists a unique arrow $\chi_f : D \to \Omega$ (the {\emph characterstic arrow} of $f$) making the following square a pullback:

\centerline{
\xymatrix{
A \: \ar[d]_{!} \ar@{^{(}->}[r]^f & D \ar[d]^{\exists! \chi_f} \\
{\bf 1} \ar[r]_{\top} & \Omega
}}

Consider ${\bf Top}$, the category of topological spaces. Although it is not an elementary topos ({\bf Top} has no exponentiation objects), however it has an open subspace classifier.
The Sierpinski space $\Sigma$ is the space on the two-element set $2 = \{ 0, 1 \}$ with opens $\emptyset$, $2$ and $\{ 1 \}$. Let $D$ be a topological space and $A$ its open subspace, so the following diagram

\centerline{
\xymatrix{
A \: \ar[d]_{!} \ar@{^{(}->}[r] & D \ar[d]^{\chi_A} \\
{\bf 1} \ar[r]_{\top} & \Sigma
}}

says that there is a unique continuous function $\chi_A$ defined as
\begin{center}
$\chi_A(x) = \begin{cases} 1 \text{  if $x \in A$} \\ 0 \text{  otherwise} \end{cases} $
\end{center}
such that $A = \chi_A^{-1}({\bf 1})$.

Also the Sierpinski space also allows us classifying closed subspaces. Let $D$ be a topological space and $A$ a closed subspace of $D$. The following diagram

\centerline{
\xymatrix{
A \: \ar[d]_{!} \ar@{^{(}->}[r] & D \ar[d]^{\chi_A} \\
{\bf 0} \ar[r]_{\bot} & \Sigma
}}
says that there is a unique continuous function $\chi_A$ such that $A = \chi_A^{-1}({\bf 0})$.

As in the example with the Sierpinski space, we shall write $\chi_A$ for characterstic arrows instead of $\chi_f$ to make notation closer to usual set-theoretic mathematics.

One can establish the criterion of subobject equality in term of a subobject classifier.

\begin{lemma}

Let $\mathcal{C}$ be a category with a subobject classifier $\Omega$, then for all $f : A \hookrightarrow D$ and $g : B \hookrightarrow D$, then

\begin{center}
$f \simeq g$ iff $\chi_A = \chi_B$
\end{center}

\end{lemma}

\begin{proof}
Suppose $\chi_A = \chi_B$. But the axioms of a subobject classifier, the following square is a pullback:

\centerline{
\xymatrix{
B \ar@/_/[ddr]_{!} \ar@/^/[drr]^g
\ar@{.>}[dr]^{k} \\
& A \ar[d]_{!} \ar[r]^f
& X \ar[d]^{\chi_A} \\
& {\bf 1} \ar[r]_{\top} & \Omega }
}

By assumption, the outer square commutes, the inner square is a pullback, so we have a unique arrow $k$ that factors $g$ through $h$, so $g \subseteq f$. One can show that $f \subseteq g$ similarly.

If $f \simeq g$, then $k$ is iso, so the outer square is a pullback, and that implies that $\chi_A$ is the unique character of $B$, so $\chi_A = \chi_B$.
\end{proof}

Moreover, we have:
\begin{lemma}
Let $\mathcal{C}$ be a locally small category with a terminal object and a subobject classifier $\Omega$. Let $A \in \operatorname{Ob}(\mathcal{C})$, define the set:

\begin{center}
$\operatorname{Sub}(A) = \{ B \in \operatorname{Ob}(\mathcal{C}) \: | \: B \hookrightarrow A \}$
\end{center}

then $\operatorname{Sub}(A) \cong \operatorname{Hom}_{\mathcal{C}}(A, \Omega)$
\end{lemma}

\begin{proof}
Follows from the lemma above. The map $f : B \mapsto \chi_B$ establishes a bijection.
\end{proof}

\subsection{Elementary topoi}

A category $\mathcal{C}$ is called an \emph{elementary topos} if:
\begin{itemize}
\item $\mathcal{C}$ is Cartesian closed,
\item $\mathcal{C}$ has coproducts,
\item $\mathcal{C}$ has an initial object ${\bf 0}$,
\item $\mathcal{C}$ has a subobject classifier $\Omega$.
\end{itemize}

Moreover, every $\operatorname{Sub}(A)$ is a Heyting algebra, so one can extract truth arrows $\neg$, $\land$, $\vee$, $\Rightarrow$ and also the binary relation $\leq$ that reflect Heyting algebra operations and ordering. Let us define them explicitly. Let $\mathcal{E}$ be an elementary topos.
\begin{itemize}
\item $\neg : \Omega \to \Omega$ is the arrow making this square pullback:

\centerline{
\xymatrix{
{\bf 1} \ar[r]^{\bot} \ar[d]_{id_A} & \Omega \ar[d]^{\neg} \\
{\bf 1} \ar[r]_{\top} & \Omega
}}

where $\bot$ is the character of ${\bf 0}$ considered as a subobject of ${\bf 1}$:

\centerline{
\xymatrix{
{\bf 0} \ar[r] \ar[d]_{!} & {\bf 1} \ar[d]^{\bot} \\
{\bf 1} \ar[r]_{\top} & \Omega
}}
\item $\wedge : \Omega \times \Omega \to \Omega$ is the character of the product arrow $(\top, \top) : {\bf 1} \to \Omega \times \Omega$:

\centerline{
\xymatrix{
{\bf 1} \ar[rr]^{(\top, \top)} \ar[d]_{id_{\bf 1}} && \Omega \times \Omega \ar[d]^{\wedge} \\
{\bf 1} \ar[rr]_{\top} && \Omega
}
}
\item Ordering relation is a monomorphism $e : \: \leq \: \hookrightarrow \Omega \times \Omega$, which is the equaliser of

\centerline{
\xymatrix{
\Omega \times \Omega \ar@/^/[rr]^{\wedge} \ar@/_/[rr]_{\pi_1} && \Omega
}
}

\item $\vee : \Omega \times \Omega \to \Omega$ is the character of the arrow $[(\top, id_{\Omega}),(id_{\Omega}, \top)] : \Omega + \Omega \to \Omega \times \Omega$
\end{itemize}

\begin{lemma}
Let $\mathcal{E}$ be an elementary topos with a subobject classifier $\top : {\bf 1} \to \Omega$ and let $D \in \operatorname{Ob}(\mathcal{E})$, then the structure $(\operatorname{Hom}_{\mathcal{E}}(D, \Omega), \wedge, \vee, \Rightarrow, \neg)$ is a Heyting algebra, where operations are defined by:

\begin{itemize}
\item $\neg p = \neg \circ p$,
\item $p \wedge q = \wedge \circ (p, q)$,
\item $p \vee q = \vee \circ (p, q)$,
\item $p \Rightarrow q = \: \Rightarrow \: \circ \: (p, q)$.
\end{itemize}
\end{lemma}

\subsection{Lawvere-Tierney topology}

Let $\mathcal{E}$ be an elementary topos. A Lawvere-Tierney topology on $\mathcal{E}$ is an arrow $j : \Omega \to \Omega$ making the following diagrams commute:

\centerline{
\xymatrix{
{\bf 1} \ar[d]_{\top} \ar[dr]^{\top} && \Omega \ar[d]_{j} \ar[dr]^j && \Omega \times \Omega \ar[d]_{j \times j} \ar[r]^{\land} & \Omega \ar[d]^j \\
\Omega \ar[r]_{j} & \Omega & \Omega \ar[r]_{j} & \Omega & \Omega \times \Omega \ar[r]_{\land} & \Omega
}
}
That is:
\begin{enumerate}
\item $j \circ \top = \top$
\item $j \circ j = j$
\item $j \circ \wedge = \wedge \circ (j \times j)$
\end{enumerate}

A tuple $\mathcal{E}_j = (\mathcal{E}, j)$ is called an \emph{elementary site}.

\begin{prop}
$n : h \mapsto j \circ h$ is a nucleus on $\operatorname{Hom}_\mathcal{E}(D, \Omega)$
\end{prop}

\subsection{An example of an elementary site}

\begin{lemma}
Let $\mathcal{P}$ be a poset, then one can define an elementary site on the category of set-valued functors $Set^{\mathcal{P}}$.
\end{lemma}

\begin{proof}
Define $F_{pq}$ as an arrow $F(p) \to F(q)$, an image of $p \leq q$ in $Set$.

First of all, let us show that $Set^{\mathcal{P}}$ is an elementary topos.
\begin{itemize}
\item Subobject classifier
\item Pullbacks
\item Exponentiation
\item Terminal object:
The terminal object is the constant functor ${\bf 1 } : \mathcal{P} \to Set$ such that ${\bf 1} : \underline{\:\:} \mapsto \{ \emptyset \}$.
\end{itemize}
\end{proof}


\section{Locales and quantales}

\subsection{Locales}

A frame is a complete lattice $\mathcal{L} = (L, \wedge, \bigvee)$ such that, for all $a \in L$ and $A \subseteq L$:
\begin{center}
$a \wedge \bigvee A = \bigvee \{ a \wedge b \: | \: b \in A \}$
\end{center}
A frame homomorphism is a map between frames that preserves $0$, $1$, $\wedge$ and $\bigvee$. The ${\bf Frm}$ is the category of all frames and homeomorphisms, the category of locales ${\bf Loc}$ is said to be the opposite category of the category of frames.

\subsection{Quantales}

The notion of a quantale generalises frames. A quantale $\mathcal{Q} = (Q, \cdot, \bigvee)$ is a complete lattice-ordered semigroup such that, for all $a \in Q$ and $A \subseteq Q$:
\begin{center}
$a \cdot \bigvee A = \bigvee \{ a \cdot b \: | \: b \in A \}$

$\bigvee A \cdot a = \bigvee \{ b \cdot a \: | \: b \in A \}$.
\end{center}

\subsection{Examples of quantales}

Let $\operatorname{Sub}(\mathcal{R})$ be the set of all additive subgroups of a ring $\mathcal{R}$. Let $A \subseteq \operatorname{Sub}(\mathcal{R})$ and $G, H \in \operatorname{Sub}(\mathcal{R})$, define supremum and product as follows:
\begin{center}
$\bigvee A = \{ \sum A' \: | \: A' \subseteq_{fin} A \}$,

$G \cdot H = \{ \sum \limits_{i = 0}^n a_i b_i \: | \: a_i \in G, b_i \in H, n < \omega \}$
\end{center}

\subsubsection{Quantales from $C^{*}$-algebras}

This subsection is based on \cite{mulvey2001quantisation}.

The first is to define $C^{*}$-algebras. Let $K$ be a field, an \emph{associative $K$-algebra} is a vector space $A$ over $K$ with a bilinear map $\times : A \times A \to A$, which is also associative. A Banach algebra is a $K$-algebra (where $K$ is either $\mathbb{R}$ or $\mathbb{C}$), which is also a Banach space, i.e., a complete normed vector space and the norm satisfies the inequation, for all $x, y \in A$:
\begin{center}
$||x \times y|| \leq ||x|| \cdot ||y||$
\end{center}

A $C^{*}$-algebra is a Banach algebra $A$ over the field of complex numbers with the involution operation $* : A \to A$ such that, for all $x, y \in A$:
\begin{itemize}
\item $(x + y) = x^* + y^*$
\item $(x \times y)^* = y^* \times x^*$
\item $\forall \lambda \in \mathbb{C} \: (\lambda x)^* = \lambda \cdot x^*$
\item $||x^* \times x|| = ||x||\cdot||x^*||$
\end{itemize}

Let $I \subseteq A$ be a vector subspace of a $C^*$-algebra $A$, then $I$ is an (two-sided) ideal, if:
\begin{itemize}
\item $a \in A$ and $b \in I$ implies $a \times b \in I$,
\item $a \in I$ and $b \in A$ implies $a \times b \in I$.
\end{itemize}
An ideal is closed, if it is closed subset of $A$ in the norm topology. One can show that any ideal is closed under involution.

TODO: Let $A$ be a $C^*$-algebra, define the \emph{spectrum} of $A$ as

\section{Quantalic cover schemes for quantale representation}

This subsection is based on \cite{goldblatt2006kripke}.

Let $\mathcal{P} = (P, \leq)$ be a poset and $x \in \mathcal{P}$, the upper cone generated by $x$ is the set $\uparrow x = \{ y \in P \: | \: x \leq y \}$. Let $A \subseteq \mathcal{P}$, define $\uparrow A$ as
\begin{center}
$\uparrow A = \bigcup \limits_{x \in A} \uparrow x$
\end{center}
A subset set $A$ is upward closed whenever $\uparrow A = A$.
We say that $y$ \emph{refines} $x$ if $x \leq y$, or, equivalently, $\uparrow y \subseteq \uparrow x$. We say that a subset $Y$ \emph{refines} if $Y \subseteq \uparrow X$, that is, every element of $y$ refines some element of $X$. The set $\operatorname{Up}(\mathcal{P})$ is the set of all upward closed subsets of $\mathcal{P}$.

Let $\mathcal{Q}$ be a quantale, a function $j : \mathcal{Q} \to \mathcal{Q}$ is a \emph{quantic nucleus}, if $f$ is a closure operator such that $j a \cdot j b \leq j (a \cdot b)$. An element $a$ is $j$-closed iff $j a = a$.

Let $\mathcal{S} = (S, \cdot, \leq)$ be a partially ordered semigroup and $\operatorname{Cov} : \mathcal{S} \to 2^{2^{\mathcal{S}}}$ a function that assigns every $x \in S$ to the collection of subsets $\operatorname{Cov}(x)$ called $x$-covers. A \emph{quantalic cover scheme} is a structure $\mathcal{C} = (\mathcal{S}, \operatorname{Cov})$, where $\mathcal{S}$ is a partially ordered semigroup and $\operatorname{Cov}$ is a covering function such that:
\begin{enumerate}
\item For all $x \in \mathcal{P}$ there exists $C \subseteq \mathcal{P}$ such that $C \in \operatorname{Cov}(x)$ and $C \subseteq \uparrow x$,
\item If $C \in \operatorname{Cov}(x)$ and for all $y \in \operatorname{Cov}(C_y)$, then $\bigcup \limits_{y \in C} C_y$,
\item If $x \leq y$, then every $x$-cover can be refined to some $y$-cover, that is, if $C \in \operatorname{Cov}(x)$, then $C' \in \operatorname{Cov}(y)$ such that $C' \subseteq \uparrow C$,
\item If $C \in \operatorname{Cov}(x)$ and $D \in \operatorname{Cov}(y)$, then $C \cdot D$ can be refined by an $x \cdot y$-cover,
\item If $C \in \operatorname{Cov}(x)$ such that $C$ refines $C \cdot D$, then there are $x', y' \in \mathcal{S}$ and $C' \subseteq C$ and $D' \subseteq D$ such that $x' \cdot y' \leq x$ and $C' \in \operatorname{Cov}(x')$ and $D' \in \operatorname{Cov}(y')$.
\end{enumerate}

Given a partially ordered semigroup $\mathcal{S} = (S, \cdot, \leq)$, we can associate the quantale of upsets $\operatorname{Up}(\mathcal{S}) = (\operatorname{Up}(S), \bullet, \subseteq)$, where product is defined by the upward closure of pointwise product.

Given a cover scheme $\mathcal{C} = (\mathcal{S}, \operatorname{Cov})$. Define a function $j : \operatorname{Up}(\mathcal{S}) \to \operatorname{Up}(\mathcal{S})$:
\begin{center}
$j X = \{ x \in \mathcal{S} \: | \: \exists C \in \operatorname{Cov}(x) \: | \: C \subseteq X \}$
\end{center}

\begin{lemma}
$j (X \bullet Y) \subseteq j X \bullet j Y$, and, therefore, $j$ is a quantic nucleus on the quantale of upsets $\operatorname{Up}(\mathcal{S}) = (\operatorname{Up}(S), \bullet, \subseteq)$.
\end{lemma}

\begin{proof}
$z \in j (X \bullet Y)$, then there are $x, y$ and there are $C \subseteq X$ and $D \subseteq Y$ such that $C \in \operatorname{Cov}(x)$ and $D \in \operatorname{Cov}(y)$ by the definition of $j$. By the forth axiom, $C \cdot D$ can be refined by an $x \cdot y$-cover $A \subseteq \uparrow (C \cdot D)$, so by the third axiom there exists a $z$-cover $E \subseteq \uparrow (C \cdot D) = C \bullet D$, so $z \in E$, and then $z \in j (C \bullet D)$
\end{proof}

Let $\mathcal{C} = (\mathcal{S}, \operatorname{Cov})$ be a cover scheme, the complex algebra of $\mathcal{C}$, is the quantale $\mathcal{C}^{+} = (\operatorname{Up}(\mathcal{S})_j, \bullet, \bigvee)$, where
\begin{center}
$\bigvee A = j (\bigcup A)$
\end{center}

Dually, given a quantale $\mathcal{Q}$, define $\mathcal{Q}_+ = (\mathcal{Q}, \preceq, \operatorname{Cov})$, where
$x \preceq y$ iff $y \leq x$ and $C \in \operatorname{Cov}(x)$ iff $x \leq \bigvee C$. Product is defined by product in $\mathcal{Q}$.

\begin{lemma}
$\mathcal{Q}_+$ satisfies the quantalic cover scheme axioms
\end{lemma}

\begin{theorem}
Let $\mathcal{Q}$ be a quantale, then $\mathcal{Q} \cong (\mathcal{Q}_+)^+$.
\end{theorem}

\section{Localic cover schemes for locale representation}

This subsection is based on \cite{goldblatt2011cover}. See also \cite{Bell2003CoverSF}.

A \emph{localic cover scheme} is a tuple $\mathcal{C} = (\mathcal{P}, \operatorname{Cov})$, where $\mathcal{P}$ is a poset and $\operatorname{Cov} : \mathcal{P} \to 2^{2^{\mathcal{P}}}$ (we call the $\operatorname{Cov}(x)$ \emph{covers of $x$} or \emph{$x$-covers}) such that:
\begin{itemize}
\item For all $x \in \mathcal{P}$ there exists $C \subseteq \mathcal{P}$ such that $C \in \operatorname{Cov}(x)$ and $C \subseteq \uparrow x$,
\item If $C \in \operatorname{Cov}(x)$ and for all $y \in \operatorname{Cov}(C_y)$, then $\bigcup \limits_{y \in C} C_y$,
\item If $x \leq y$, then every $x$-cover can be refined to some $y$-cover, that is, if $C \in \operatorname{Cov}(x)$, then $C' \in \operatorname{Cov}(y)$ such that $C' \subseteq \uparrow C$,
\item Every $x$-cover is included in $\uparrow x$.
\end{itemize}

Goldblatt uses the term "localic cover scheme" for cover schemes where the forth condition is weaker than ours. According to Goldblatt's terminology, a cover scheme as above is called a \emph{strict localic cover scheme}. In this subsection, we are not going to consider other cover schemes except for localic ones, so we will be ommiting the word ``localic'' most of the times.

Let $\mathcal{C} = (\mathcal{P}, \operatorname{Cov})$ be a localic cover scheme. Define an operator $j : 2^\mathcal{P}
\to 2^\mathcal{P}$:
\begin{center}
$j A = \{ x \in \mathcal{P} \: | \: \exists C \subseteq \mathcal{P} \: C \in \operatorname{Cov}(x) \: \& \: C \subseteq A\}$
\end{center}

An upward closed subset of a cover scheme is localised if $j A = A$. $\operatorname{Up}(\mathcal{P})_j$ is the set of all $j$-localised subsetes of $\mathcal{P}$

\begin{lemma} Let $\mathcal{C} = (\mathcal{P}, \operatorname{Cov})$ be a cover scheme and $A$ an upset, then

\begin{enumerate}
\item $j A$ is an upset,
\item $j$ is a closure operator on $\operatorname{Up}(\mathcal{P})$,
\item $j (A \cap B) = j A \cap j B$.
\end{enumerate}

\end{lemma}

\begin{proof}
$ $
\begin{enumerate}
\item Let $x \in j A$ and $x \leq y$. We need $y \in j A$.

By the definition of $j$, there exists $C \in \operatorname{Cov}(x)$ such that $C \subseteq A$.
By the refinement axiom, we have $C' \in \operatorname{Cov}(y)$ such that $C' \subseteq \uparrow C$.
But $\uparrow C \subseteq \uparrow A = A$, so $y \in j A$, that makes $j A$ upward closed.
\item Let $x \in A$, then by the first axiom, we have $C \in \operatorname{x}$ with $C \subseteq \uparrow x \subseteq A$, so $x \in j A$. Idempotence follows from transitivity (the third axiom).

\item To show multiplicativity, this is enough to show $A \cap j B \subseteq j (A \cap B)$.
Let $x \in A \cap j B$. Then there exists an $x$-cover $C \subseteq B$, but every $x$-cover is included in $\uparrow x$, but $\uparrow x \subseteq A$ and also $\uparrow C \subseteq B$, so $x \in j (A \cap B)$
\end{enumerate}
\end{proof}

Let $\mathcal{C} = (\mathcal{P}, \operatorname{Cov})$ be a cover scheme, the complex algebra of a cover scheme is a structure $\mathcal{C}^{+} = (\operatorname{Up}(\mathcal{P})_j, \wedge, \bigvee)$, where
\begin{itemize}
\item $A \wedge B = A \cap B$,
\item $\bigvee \limits_{i \in I} A_i = j(\bigcup \limits_{i \in I} A)$
\end{itemize}.

\begin{lemma}
$\mathcal{C}^{+}$ is well-defined, moreover, $\mathcal{C}^{+}$ is a frame.
\end{lemma}

\begin{proof}
$A \wedge \bigvee \limits_{i \in I} A_i = A \cap j (\bigcup \limits_{i \in I} A_i) = j A \cap j (\bigcup \limits_{i \in I} A_i) = j (A \cap \bigcup \limits_{i \in I} A_i) = j (\bigcup \limits_{i \in I} A \cap A_i) = \bigvee \limits_{i \in I} (A \wedge A_i)$
\end{proof}

Dually, let $\mathcal{L} = (L, \wedge, \bigvee)$ be a frame, then its dual cover scheme $\mathcal{L}_+ = (L, \preceq, \operatorname{Cov})$, where $(L, \preceq)$ is a dual poset of $L$, that is, $x \preceq y$ iff $y \leq x$ and $C \in \operatorname{Cov}(x)$ iff $x = \bigvee C$. Clearly the upper cone generated by $x$ in $(L, \leq)$ is the same as the lower cone generated by $x$ in $(L, \preceq)$. We denote it as $(a]$

\begin{lemma} Let $\mathcal{L}$ be a frame, then $\mathcal{L}_+$ is a localic cover scheme
\end{lemma}
\begin{proof}
We have to verify four axioms.

\begin{itemize}
\item Let $x \in \mathcal{L}$, then $x = \bigvee (x]$, so $\bigvee (x]$ is an $x$-cover that obviously contains $\uparrow x$.
\item Let $x = \bigvee C$ and for all $y \in C$ we have $y = \bigvee \limits_{y \in C} C_y$, then
\begin{center}
$x = \bigvee \limits_{y \in C} \bigvee C_y = \bigvee \bigvee \limits_{y \in C} C_y = \bigvee (\bigcup \limits_{y \in C} C_y)$, so $x$ is also covered by $\bigcup \limits_{y \in C} C_y$.
\end{center}
\item Let $x \leq y$ and $x = \bigvee C$. Let $C' = \{ y \wedge c \: | \: c \in C \}$, then $y = \bigvee C'$ is a $y$-cover and $C'$ refines $C$ since $y \wedge c \leq c$.
\item Let $x = \bigvee C$, so $C \subseteq \uparrow x$
\end{itemize}
\end{proof}

\begin{theorem} (Representation theorem)

$\mathcal{L} \cong (\mathcal{L}_+)^{+}$
\end{theorem}

\begin{proof}
By mapping $x \mapsto (x]$.
\end{proof}

\section{Geometric logic and geometric categories}

\subsection{First-order language and geometric logic}

The first-order signature $\Sigma$ that we are going to consider in this section consists of the following data:
\begin{itemize}
\item A set $\Sigma-\operatorname{Sort}$ of sorts,
\item A set $\Sigma-\operatorname{Fun}$ of function symbols having the form $f : A_1 \times \dots \times A_n \to B$ where $A_1, \dots, A_n, B$ are sorts,
\item A set $\Sigma-\operatorname{Fun}$ of predicate symbols having the form $R \hookrightarrow A_1 \times \dots \times A_n$, where $A_1, \dots, A_n$ are sorts,
\end{itemize}

The collection of terms is defined inductively:
\begin{itemize}
\item A variable $x^A$ of sort $A$ is a term of sort $A$,
\item If $t_1 : A_1, \dots, t_n : A_n$ are terms of sorts $A_1, \dots, A_n$ and $f : A_1 \times \dots \times A_n \to B$ is a function symbol, then $f(t_1, \dots, t_n) : B$ is a term of sort $B$.
\end{itemize}

The set of formulas is also defined inductively:
\begin{itemize}
\item Let $t_1 : A_1, \dots, t_n : A_n$ be terms of of sorts $A_1, \dots, A_n$ and let $R \hookrightarrow A_1 \times \dots \times A_n$ be a predicate symbol, then $R(t_1, \dots, t_n)$ is an atomic formula,
\item Let $t_1, t_2$ be terms of sort $A$, then $t_1 = t_2$ is an atomic formula,
\item If $\varphi$ and $\psi$ are formulas, so is $(\varphi \wedge \psi)$.
\item Let $I$ be an index set and $\{ \varphi_i \: | \: i \in I \}$ a family of formulas such that $|\operatorname{FV}((\varphi_i)_{i \in I})| < \omega$, then $\bigvee \limits_{i \in I} \varphi_i$ is a formula
\item If $\varphi$ is a formula and $x \in \operatorname{FV}(\varphi)$, then $\exists x \varphi$ is a formula and $\operatorname{FV}(\exists x \varphi) = \operatorname{FV}(\varphi) \setminus \{ x \}$.
\end{itemize}

\begin{enumerate}
\item The set of \emph{atomic} formulas over $\Sigma$ is the set of formulas closed under relations and equality,
\item The set of \emph{Horn} formulas over $\Sigma$ is the set of formulas closed under finite conjunction,
\item The set of \emph{regular} formulas over $\Sigma$ is the set of Horn formulas closed under existential quantification,
\item The set of \emph{coherent} formulas is the set of regular formulas closed under finite disjunction,
\item The class of \emph{geometric} formulas is the class of coherent formulas closed under infinite disjunction.
\end{enumerate}

A \emph{context} is a finite list $\vec{x} = (x_1, \dots, x_n)$. A formula $\varphi$ in a context $\vec{x}$ if its every free variable belongs to $\vec{x}$. We shall use the standard notation $\varphi(\vec{x})$.

\begin{enumerate}
\item A sequent over signature $\Sigma$ is a pair of formulas $\varphi \vdash_{\vec{x}} \psi$ such that their free variables occur in $\vec{x}$,
\item A sequent $\varphi \vdash_{\vec{x}} \psi$ is \emph{atomic} (\emph{Horn}, \emph{regular}, \emph{coherent}, \emph{geometric}) if $\varphi$ and $\psi$ are  \emph{atomic} (\emph{Horn}, \emph{regular}, \emph{coherent}, \emph{geometric}).
\end{enumerate}

The minimal geometric logic is the minimal theory $\mathbb{T}$ that contains the following axioms and is closed under the inference rules:
\begin{prooftree}
\AxiomC{$ $}
\UnaryInfC{$\varphi \vdash_{\vec{x}} \varphi$}
\end{prooftree}

\begin{minipage}{0.5\textwidth}
\begin{flushleft}
\begin{prooftree}
\AxiomC{$ $}
\UnaryInfC{$\varphi \vdash_{\vec{x}} \top$}
\end{prooftree}

\begin{prooftree}
\AxiomC{$ $}
\UnaryInfC{$\varphi_1 \land \varphi_2 \vdash_{\vec{x}}  \varphi_i$}
\end{prooftree}

\begin{prooftree}
  \AxiomC{$\varphi \vdash_{\vec{x}} \psi$}
  \AxiomC{$\varphi \vdash_{\vec{x}} \theta$}
  \BinaryInfC{$\varphi \vdash_{\vec{x}} \psi \land \theta$}
\end{prooftree}

\begin{prooftree}
\AxiomC{$\varphi \vdash_{\vec{x}, y}  \psi$}
\RightLabel{$y \notin FV(\varphi)$}
\UnaryInfC{$\exists y \varphi \vdash \psi$}
\end{prooftree}

\begin{prooftree}
  \AxiomC{$\varphi \vdash_{\vec{x}} \psi$}
  \AxiomC{$\psi \vdash_{\vec{x}} \theta$}
  \BinaryInfC{$\varphi \vdash_{\vec{x}} \theta$}
\end{prooftree}

\end{flushleft}
\end{minipage}\hfill
\begin{minipage}{0.5\textwidth}
\begin{flushright}
\begin{prooftree}
\AxiomC{$ $}
\RightLabel{$\varphi(\vec{x}) \in \Phi$}
\UnaryInfC{$\varphi \vdash_{\vec{x}} \bigvee \Phi$}
\end{prooftree}

\begin{prooftree}
\AxiomC{$\varphi \vdash_{\vec{x}} \psi$}
\RightLabel{$\varphi \in \Phi$}
\UnaryInfC{$\bigvee \Phi \vdash_{\vec{x}} \psi$}
\end{prooftree}

\begin{prooftree}
\AxiomC{$ $}
\UnaryInfC{$\varphi \land \bigvee \Phi \vdash_{\vec{x}} \bigvee \limits_{\phi \in \Phi} (\varphi \land \phi$)}
\end{prooftree}

\begin{prooftree}
\AxiomC{$\exists y \varphi \vdash_{\vec{x}} \psi$}
\RightLabel{$y \notin FV(\varphi)$}
\UnaryInfC{$\varphi \vdash_{\vec{x}, y} \psi$}
\end{prooftree}

\begin{prooftree}
\AxiomC{$ $}
\RightLabel{$x \notin FV(\psi)$}
\UnaryInfC{$\varphi \land \exists x \psi \vdash_{\vec{x}} \exists x (\varphi \land \phi$)}
\end{prooftree}

\end{flushright}
\end{minipage}

\vspace{\baselineskip}

Let $\mathcal{C}$ be a category with finite products and $\Sigma$ a signature. A $\Sigma$-structure $\mathcal{M}$ over $\mathcal{C}$ in $\mathcal{C}$ consists of the following data:
\begin{enumerate}
\item Let $A$ be a sort, then $\mathcal{M} A \in \operatorname{Ob}(\mathcal{A})$,
\item Let $A_1, A_2, \dots, A_n, B$ be sorts and $f$ a function symbol of sort $A_1 \times A_2 \times \dots \times A_n \to B$, then $\mathcal{M} f : \mathcal{M} A_1 \times \mathcal{M} A_2 \times \dots \times \mathcal{M} A_n \to \mathcal{M} B$ is a $\mathcal{C}$-arrow,
\item Let $A_1, A_2, \dots, A_n$ be sorts and $R \hookrightarrow A_1 \times A_2 \times \dots \times A_n$ a relation symbol, then $\mathcal{M} R \hookrightarrow \mathcal{M} A_1 \times \mathcal{M} A_2 \times \dots \times \mathcal{M} A_n$ is a subobject.
\end{enumerate}

\subsection{Regular, coherent and geometric categories}

\subsubsection{Regular categories}

Let $\mathcal{C}$ be a Cartesian category. $\mathcal{C}$ has images, if there exists a subobject
$\operatorname{Im}(f)$ for each $f : A \to B$ such that the following triangle commutes:

\centerline{
\xymatrix{
A \ar[rr]^f \ar[dr] && B \\
& \operatorname{Im}(f) \ar[ur]
}
}

A category is called \emph{regular} if all images are stable under pullbacks.

\subsubsection{Coherent categories}

\subsubsection{Geometric categories}

\subsection{Interpretation of the geometric language}

Let $\mathcal{M}, \mathcal{N}$ be $\Sigma$-structures over $\mathcal{C}$, then a $\Sigma$-structure homomorphism $h : M \to N$ is a collection of arrows $h : \mathcal{M} A \to N A$ for each $A \in \operatorname{Ob}(\mathcal{C})$ making the following diagrams commute for any function symbol $f$ and any relation symbol $R$:

\centerline{
\xymatrix{
\mathcal{M} A_1 \times \dots \times \mathcal{M} A_n \ar[rr]^{\mathcal{M} f} \ar[d]_{h_{A_1} \times \dots \times h_{A_n}} && \mathcal{M} B \ar[d]^{h_B} && \mathcal{M} R \ar[d]_{h_R} \:\: \ar@{^{(}->}[rr] && \mathcal{M} A_1 \times \dots \times \mathcal{M} A_n \ar[d]^{h_{A_1} \times \dots \times h_{A_n}} \\
\mathcal{N} A_1 \times \dots \times \mathcal{N} A_n \ar[rr]_{\mathcal{N} f} && \mathcal{N} B && \mathcal{N} R \:\: \ar@{^{(}->}[rr] && \mathcal{N} A_1 \times \dots \times \mathcal{N} A_n
}
}

Now we define the inductive inductive interpretation of terms and formulas. Let $\mathcal{M}$ be a $\Sigma$-structure in a category $\mathcal{C}$ closed under finite limits.

A term-in-context $\{ \vec{x}. t \}$ (where $x_i : A_i$) has the interpretation as an arrow of the form
\begin{center}
$[\![\vec{x}. t]\!]_{\mathcal{M}} : \mathcal{M} A_1 \times \dots \times \mathcal{M} A_n \to \mathcal{M} B$
\end{center}
built by induction:
\begin{enumerate}
\item If $t = x_i$, then $[\![x_i]\!]_{\mathcal{M}}$ is a projection $\pi_i : \mathcal{M} A_1 \times \dots \times \mathcal{M} A_n \to \mathcal{M} A_i$,
\item If $t = f(t_1, \dots, t_n)$ (each $t_i : C_i$), then $[\![f(t_1, \dots, t_n)]\!]_{\mathcal{M}}$ has the form

\centerline{
\xymatrix{
\mathcal{M} A_1 \times \dots \times \mathcal{M} A_n \ar[rrr]^{([\![\vec{x}. t_1]\!]_{\mathcal{M}}, \dots, [\![\vec{x}. t_m]_{\mathcal{M}}\!])} &&& \mathcal{M} C_1 \times \dots \times \mathcal{M} C_m \ar[rrr]^f &&& \mathcal{M} B
}
}
\end{enumerate}

A formula-in-context $\{ \vec{x}. \varphi \}$ is interpreted as a subobject $[\![\vec{x}. \varphi]\!]_{\mathcal{M}} \hookrightarrow \mathcal{M} A_1 \times \dots \times \mathcal{M} A_n$ by induction.

\begin{enumerate}
\item Let $R$ be a relation symbol of type $B_1, \dots, B_n$ and $\varphi(t_1, \dots, t_n)$, then $[\![\varphi(t_1, \dots, t_n)]\!]_{\mathcal{M}}$ is the pullback

\centerline{
\xymatrix{
[\![\vec{x}.\varphi]\!]_{\mathcal{M}} \ar[rrr] \ar[d] &&& \mathcal{M} R \ar[d] \\
\mathcal{M} A_1 \times \dots \times \mathcal{M} A_n \ar[rrr]_{([\![\vec{x}.t_1]\!]_{\mathcal{M}}, \dots, [\![\vec{x}.t_m]\!]_{\mathcal{M}})} &&& \mathcal{M} B_1 \times \dots \times \mathcal{M} B_m
}}

\item If $\varphi(\vec{x})$ has the form $s = t$, where $s$ and $t$ are terms of sort $B$, then $[\![\vec{x}.\varphi]\!]$ is the equaliser of $[\![\vec{x}.s]\!]_{\mathcal{M}}$ and $[\![\vec{x}.t]\!]_{\mathcal{M}}$:

\centerline{
\xymatrix{
[\![\vec{x}. \varphi]\!]_{\mathcal{M}} \ar[rr]^e && \mathcal{M} A_1 \times \dots \times \mathcal{M} A_n \ar@<1ex>[rrr]^{[\![\vec{x}.s]\!]_{\mathcal{M}}} \ar@<-1ex>[rrr]_{[\![\vec{x}.t]\!]_{\mathcal{M}}} &&& \mathcal{M} B
}
}

\item If $\varphi(\vec{x}) = \psi \land \theta$, then $[\![\vec{x}. \varphi]\!]_{\mathcal{M}}$ is the fibred product:

\centerline{
\xymatrix{
[\![\vec{x}. \psi \land \theta]\!]_{\mathcal{M}} \ar[rr] \ar[d] && [\![\vec{x}. \theta]\!]_{\mathcal{M}} \ar[d] \\
[\![\vec{x}. \psi]\!] \ar[rr]_{\mathcal{M}} && \mathcal{M} A_1 \times \dots \times \mathcal{M} A_n
}
}

\item If $\varphi(\vec{x}) = \psi \lor \theta$ and $\mathcal{C}$ is coherent, then $[\![\vec{x}. \psi \lor \theta]\!]_{\mathcal{M}}$ is the union of $[\![\vec{x}. \psi]\!]_{\mathcal{M}}$ and $[\![\vec{x}. \theta]\!]_{\mathcal{M}}$.

\item If $\varphi(\vec{x}) = \exists y \psi$ and $y$ is of sort $B$ and $\mathcal{C}$ is regular, then $[\![\vec{x}. \exists y \psi]\!]_{\mathcal{M}}$ is the image of the composition

\centerline{
\xymatrix{
[\![\vec{x}, y. \psi]\!]_{\mathcal{M}} \ar[rr] && \mathcal{M} A_1 \times \dots \times \mathcal{M} A_n \times \mathcal{M} B \ar[rr]^{\pi} && \mathcal{M} A_1 \times \dots \times\mathcal{M} A_n
}
}

\item If $\varphi(\vec{x}) = \bigvee \limits_{i \in I} \varphi_i$ and $\mathcal{C}$ is geometric, then $[\![\vec{x}. \bigvee \limits_{i \in I} \varphi_i]\!]_{\mathcal{M}}$ is the union of subobjects $[\![\vec{x}. \varphi_i]\!]_{\mathcal{M}}$.
\end{enumerate}

\section{Non-commutative geometric logic, non-commutative geometric categories and completeness}

We define the non-commutative geometric logic with the following axioms and inference rules.

The definition of a language is identical to the corresponding definition from the previous section, but we replace $\land$ with $\bullet$.

As in the commutative geometric case, the derivability sign is labelled with a context $\vec{x}$

\begin{prooftree}
\AxiomC{$ $}
\UnaryInfC{$\varphi \vdash_{\vec{x}} \varphi$}
\end{prooftree}

\begin{minipage}{0.5\textwidth}
\begin{flushleft}

\begin{prooftree}
  \AxiomC{$\varphi \vdash_{\vec{x}} \psi$}
  \UnaryInfC{$\varphi \bullet \theta \vdash_{\vec{x}} \psi \bullet \theta$}
\end{prooftree}

\begin{prooftree}
  \AxiomC{$\varphi \vdash_{\vec{x}} \psi$}
  \UnaryInfC{$\theta \bullet \varphi \vdash_{\vec{x}} \theta \bullet \psi$}
\end{prooftree}

\begin{prooftree}
\AxiomC{$ $}
\UnaryInfC{$\bigvee \Phi \bullet \varphi \vdash_{\vec{x}} \bigvee \limits_{\phi \in \Phi} (\phi \bullet \varphi)$}
\end{prooftree}

\begin{prooftree}
\AxiomC{$\varphi \vdash_{\vec{x}, y} \psi$}
\RightLabel{$y \notin FV(\varphi)$}
\doubleLine
\UnaryInfC{$\exists y \varphi \vdash_{\vec{x}} \psi$}
\end{prooftree}

\begin{prooftree}
\AxiomC{$ $}
\RightLabel{$y \notin FV(\varphi)$}
\UnaryInfC{$\exists y \psi \bullet \varphi \vdash_{\vec{x}} \exists y (\psi \bullet \varphi$)}
\end{prooftree}

\end{flushleft}
\end{minipage}\hfill
\begin{minipage}{0.5\textwidth}
\begin{flushright}
\begin{prooftree}
\AxiomC{$ $}
\RightLabel{$\varphi \in \Phi$}
\UnaryInfC{$\varphi \vdash_{\vec{x}} \bigvee \Phi$}
\end{prooftree}

\begin{prooftree}
\AxiomC{$\varphi \vdash_{\vec{x}} \psi$}
\RightLabel{$\varphi \in \Phi$}
\UnaryInfC{$\bigvee \Phi \vdash_{\vec{x}} \psi$}
\end{prooftree}

\begin{prooftree}
\AxiomC{$ $}
\UnaryInfC{$\varphi \bullet \bigvee \Phi \vdash_{\vec{x}} \bigvee \limits_{\phi \in \Phi} (\varphi \bullet \phi)$}
\end{prooftree}

\begin{prooftree}
\AxiomC{$ $}
\UnaryInfC{$\varphi \bullet (\psi \bullet \theta) {}_{\vec{x}}\dashv \vdash_{\vec{x}} (\varphi \bullet \psi) \bullet \theta$}
\end{prooftree}

\begin{prooftree}
\AxiomC{$ $}
\RightLabel{$y \notin FV(\varphi)$}
\UnaryInfC{$\varphi \bullet \exists y \psi \vdash_{\vec{x}} \exists y (\varphi \bullet \phi$)}
\end{prooftree}

\end{flushright}
\end{minipage}

\begin{prooftree}
  \AxiomC{$\varphi \vdash_{\vec{x}} \psi$}
  \AxiomC{$\psi \vdash_{\vec{x}} \theta$}
  \BinaryInfC{$\varphi \vdash_{\vec{x}} \theta$}
\end{prooftree}

\subsection{Mulvey categories with subobject classifiers}

Let $\mathcal{C}$ be a finitely complete Mulvey category with a subobject classifier. One can associate a quantale of subobjects $\operatorname{Sub}(A)$ with every $A \in \operatorname{C}$.

\section{Grothendieck topology}

\subsection{Sheaves and presheaves}

\subsubsection{Set-theoretic motivation}

This motivational part is based on \cite[Chapter 14]{goldblatt2014topoi}. For a topological space $\mathcal{X}$, $\mathcal{O}(\mathcal{X})$ will denote the lattice of opens of $\mathcal{X}$.

\vspace{\baselineskip}

Let $\mathcal{O}(\mathcal{I})$ be a topological space. A \emph{presheaf} (or \emph{stack}) over $\mathcal{O}(\mathcal{I})$ is a contravariant functor ${\bf F} : \mathcal{O}(\mathcal{I}) \to {\bf Set}$, that is, each inclusion $U \hookrightarrow V$ maps to a function ${\bf F}_U^V : {\bf F} V \to {\bf F} U$ such that
\begin{itemize}
\item ${\bf F}_U^U = id_{{\bf F} U}$
\item If $U \subseteq V \subseteq W$, then the following triangle commutes:

\centerline{
\xymatrix{
& {\bf F} W \ar[dl]_{{\bf F}_V^W} \ar[dr]^{{\bf F}_U^W} \\
{\bf F} V \ar[rr]_{{\bf F}_U^V} && {\bf F} U
}
}
\end{itemize}

\subsubsection{Set-theoretic stalks}

The notion of a presheaf generalises essentially the following construction from set-theoretic topology. First of all, we discuss a set-theoretic examples without referring to topology. Consider an indexed family of disjoint sets:
\begin{center}
$\mathcal{A} = \{ A_i \: | \: i \in I \}$.
\end{center}
We can associate an obvious map $p : A \to I$ since for every $x \in \mathcal{A}$ there is a unique $i \in I$ such that $x \in A_i$. Take

\begin{center}
$p^{-1}(\{ i \}) = \{ x \: | \: p(x) = i\} = A_i$
\end{center}

Such $p^{-1}(\{ i \})$ is called the \emph{fibre} over $i$, the whole structure is a bundle of sets over the base space $I$, $\mathcal{A}$ is the stalk space (l'espace etale) of the bundle. More generally, we can extract the bundle from every map $p : A \to I$

A morphism of bundles $(A, I)$ and $(B, I)$ is a commutative triangle of the following form:
\centerline{
\xymatrix{
A \ar[rr]^f \ar[dr]_{p_1} && B \ar[dl]^{p_2}\\
& I
}}

\subsubsection{Topological sheaves}

Topologically, a sheaf is a version of bundles for topological spaces. Let $\mathcal{I}$ be a topological space. A sheaf is a tuple $(\mathcal{A}, p)$, where $\mathcal{A}$ is a topological space and $p : \mathcal{A} \to \mathcal{I}$ is a continuous map, which is also a local homeomorphism, that is, every $x \in \mathcal{A}$ has an open neighbourhood, which is mapped homeomorphically by $p$ onto $p(U)$ and $p(U)$ is open in $\mathcal{I}$. The category of all sheaves of $\mathcal{I}$ is sometimes called a spatial topos.

We can extract a presheaf from a sheaf $(A, f)$ as a contravariant functor $F_f : \mathcal{O}(\mathcal{I}) \to {\bf Set}$ as
\begin{center}
$F_f(V) = \{ s : V \to A \: | \: \text{$s$ is continuous and $f \circ s = V \hookrightarrow \mathcal{I} $}\}$
\end{center}

The category of presheafs over $\mathcal{I}$, denoted as ${\bf PsC}(\mathcal{I})$, consists of presheafs as objects and natural transformations $\tau : F \Rightarrow G$, that is, a collection of functions $\tau_U : F(U) \to G(U)$ making this square commute whenever $U \subseteq V$

\centerline{
\xymatrix{
F(V) \ar[d]_{F^V_U} \ar[rr]^{\tau_V} && G(V) \ar[d]^{G^V_U} \\
F(U) \ar[rr]_{\tau_U} && G(U)
}}

It is clear that ${\bf PsC}(\mathcal{I})$ is equivalent to ${\bf Set}^{\theta^{Op}}$.

\subsubsection{Presheaf categories as topoi}

Let $\mathcal{C}$ be a small category, consider $\widehat{\mathcal{C}} = {\bf Set}^{\mathcal{C}^{op}}$, a presheaf category. Let us show that $\widehat{\mathcal{C}}$ has a subobject classifier.

\subsubsection{Germs}

This section is based on \cite[Chapter II, paragraph 5]{maclane2012sheaves}

Let $\mathcal{X}$ be a topological space and $\mathcal{O}(\mathcal{X})$ its lattice of opens. Let $\mathcal{O}(\mathcal{X}) : \theta \to {\bf Set}$ be a presheaf. Let $x \in X$ and let $U, V$ be open neighbourhoods of $x$.

Let $s \in F(U)$ and $t \in F(V)$. $S$ and $T$ are said to have the \emph{same germ} at $x$, whenever there exists an open set $W \subseteq U \cap V$ with $x \in W$ such that $s|W = t|W \in P(W)$. Having the same germ is an equivalence relation, and the \emph{germ} of $s$ in $x$ in an equivalence class of $s$ denoted as $germ_x s$.

The \emph{stalk} of $F$ in $x$ is the set of all germs of $x$
\begin{center}
$F_x = \{ germ_x s \: | \: s \in F(U), U \in \theta \}$
\end{center}

Let $X$ be an index set and $V$ an open set, an \emph{open cover} of $V$ is a collection of sets $\{ V_x\}_{x \in X}$ such that
\begin{center}
$V = \bigcup \limits_{x \in X} V_x$
\end{center}

Intuitively, a sheaf is a presheaf that preserves open covers.

A \emph{sheaf} is a presheaf $F$ satisfying the following two extra-principles. Let $V$ be an open set and $\{V_x
\}_{x \in X}$ an open cover, then:
\begin{enumerate}
\item Let $s, t \in F(V)$ be sections such that such that $s|_{V_x} = t|_{V_x}$ for $x \in X$, then $s = t$.
\item Let $\{ s_x \in F(V_x) \}_{x \in X}$ be a family of sections. If for all $x, y \in X$ we have $s_x|_{V_x \cap V_y} = s_y|_{V_x \cap V_y}$, then there exists a section $s \in F(V)$ such that $s|_{V_x} = s_x$ for all $x \in X$.
\end{enumerate}
Equivalently, we can reformulate the latter as that $F(V) = \varprojlim_{x \in X} F(V_x)$.
The category ${\bf Sh}(I)$ is a category of sheaves over $I$.

\subsection{Grothendieck topos}

The notion of a Grothendieck topos generalises the aforementioned topological constructions. We start with the definition of a site.

Let $\mathcal{C}$ be a locally small category. A \emph{pretopology} on $\mathcal{C}$ is an assignment of each $A \in {\bf Ob}(\mathcal{C})$ of a collection of arrows $\operatorname{Cov}(A)$ (covers of $A$, or covering sieves) with the following properties:
\begin{enumerate}
\item $\{ id_A : A \to A \} \in \operatorname{Cov}(A)$
\item If $\{ f_x : A_x \to A \: | \: x \in X \} \in \operatorname{Cov}(A)$ and for each $x \in X$ we have an $a_x$-cover
\begin{center}
$\{ f_y^x : A_y^x \to A_x \: | \: y \in Y_x \} \in \operatorname{Cov}(A_x)$
\end{center}
then
\begin{center}
$\{ f_x \circ f_y^x : A^x_y \to A \: | \: x \in X, y \in Y_x\} \in  \operatorname{Cov}(A)$
\end{center}
\item If $\{ f_x : A_x \to A \: | \: x \in X \} \in \operatorname{Cov}(A)$ and $g : B \to A$ and assume that for each $x \in X$ the pullback of $f_x$ along $g$ exists:

\centerline{
\xymatrix{
B \times_A A_x \ar[r] \ar[d]_{g_x} & A_x \ar[d]^{f_x}\\
B \ar[r]_{g} & A
}}
then $\{ g_x : B \times_A A_x \to B \:| \: x \in X\} \in \operatorname{Cov}(B)$
\end{enumerate}

A \emph{site} is the pair $(\mathcal{C}, \operatorname{Cov})$ consisting of a category and a pretopology on it.

A Grothendieck topos is a site with extra-conditions that generalise the axioms of topological sheaves in terms of a pretopology. A presheaf of sets over a category $\mathcal{C}$ is a contravariant functor $F : \mathcal{C} \to {\bf Set}$

Let $\operatorname{Cov}$ be a pretopology on a category $\mathcal{C}$ and $\{ f_x : A_x \to A \: | \: x \in X \} \in \operatorname{Cov}(A)$. Let $x, y \in X$ and we have the pullback of $f_x$ and $f_y$

\centerline{
\xymatrix{
A_x \times_A A_y \ar[r] \ar[d] & A_y \ar[d]^{f_y}\\
A_x \ar[r]_{f_x} & A
}}

If $F$ is a presheaf over $\mathcal{C}$, then we have arrows $F^x_y : F(A_x) \to F(A_x \times_A A_y)$ and $F^y_x : F(A_y) \to F(A_x \times_A A_y)$. Denote $F_x$ as the arrow $F(f_x) : F(A) \to F(A_x)$.



A presheaf $F$ is a sheaf, if for any cover $\{ f_x : A_x \to A \: | \: x \in X \} \in \operatorname{Cov}(A)$, then for all $x, y \in X$ such that for all $s_x \in F(A_x)$ and $s_y \in F(A_y)$ such that $F^x_y(s_x) = F^y_x(y)$, then there exists a unique $s \in F(A)$ such that $F_x(s) = s_x$ for $x \in X$.

${\bf Sh}(\operatorname{Cov})$ is the category of sheaves of the site $(\mathcal{C}, \operatorname{Cov})$. A Grothendieck topos is a category of sheaves of some site up to categorical equivalence.

\subsection{Grothedieck topos via sieves}

Alternatively, one can define a Grothendieck topos in terms of a Grothendieck topology as follows. Define a sieve $S$
as family morphisms in a category $\mathcal{C}$ that behaves as a right ideal:

\begin{center}
$f \in S$ implies $f \circ g \in S$
\end{center}

If $S$ is a sieve on $C \in \operatorname{Ob}(\mathcal{C})$ and $h \in Hom(D, C)$ for any $D \in \operatorname{Ob}(\mathcal{C})$, then
\begin{center}
$h^*(S) = \{ g \: | \: cod(g) = D, g \circ h \in S \}$
\end{center}

A \emph{Grothendieck topology} on a category $\mathcal{C}$ is a function $J$ that maps every $C \in \operatorname{Ob}(\mathcal{C})$, denoted as $J(C)$ such that:
\begin{enumerate}
\item the maximal sieve $t(C) = \{ f \: | \: cod(f) = C\} \in J(C)$
\item If $S \in J(C)$, then $h^*(S) \in J(D)$
\item If $S \in J(C)$ and $R$ is a sieve of $C$ such that $h^*(R) \in J(D)$ for all $h : D \to C$, then $R \in J(C)$
\end{enumerate}
Also any $J(C)$ is upward closed.

\subsection{Subobject classification in a presheaf topos}

In this subsection we describe the subobject classifier in an arbitratry presheaf category $\widehat{\mathcal{C}} = {\bf Set}^{\mathcal{C}^op}$ for a small category $\mathcal{C}$.

Let ${\bf P} : \mathcal{C}^op \Rightarrow {\bf Set}$ be a functor, a functor ${\bf Q} : \mathcal{C}^op \Rightarrow {\bf Set}$ is said to a \emph{subfunctor} of ${\bf P}$ if, for all $C \in \operatorname{Ob}(\mathcal{C})$ and $f : C \to D$ in $\mathcal{C}$
\begin{itemize}
\item ${\bf Q} C \subseteq {\bf P} C$
\item ${\bf Q} f$ is a restriction of ${\bf P} f$
\end{itemize}

The inclusion ${\bf Q} \Rightarrow {\bf P}$ is monic in $\widehat{\mathcal{C}}$, so each such a ${\bf Q}$ is a subobject.

The category $\widehat{\mathcal{C}}$ has a subobject classifier $\Omega$ that classifies subfunctors of each representable presheaf given by ${\bf y}C = \operatorname{Hom}_{\mathcal{C}}(\underline{\:\:\:}, C) : \mathcal{C}^{op} \Rightarrow {\bf Set}$. Thus
\begin{center}
$\operatorname{Sub}_{\widehat{\mathcal{C}}}(\operatorname{Hom}_{\mathcal{C}}(\underline{\:\:\:}, C)) \cong \operatorname{Hom}_{\widehat{\mathcal{C}}}(\operatorname{Hom}_{\mathcal{C}}(\underline{\:\:\:}, C), \Omega) = \operatorname{Nat}(\operatorname{Hom}_{\mathcal{C}}(\underline{\:\:\:}, C), \Omega)$
\end{center}

But by the Yoneda lemma
\begin{center}
$\Omega(C) \cong \operatorname{Nat}(\operatorname{Hom}_{\mathcal{C}}(\underline{\:\:\:}, C), \Omega)$
\end{center}

So the subobject classifier in a presheaf topos can be described as the functor $\Omega : \mathcal{C}^{op} \Rightarrow {\bf Set}$ defined as
\begin{center}
$\Omega(C) = \operatorname{Sub}_{\widehat{C}}(\operatorname{Hom}_{\mathcal{C}}(\underline{\:\:\:}, C)) = \{ {\bf S} \: | \: \text{${\bf S}$ is a subfunctor of $\operatorname{Hom}_{\mathcal{C}}(\underline{\:\:\:}, C)$}\}$
\end{center}

One can rephrase this definition in terms of sieves. Let ${\bf Q} \subseteq \operatorname{Hom}_{\mathcal{C}}(\underline{\:\:\:}, C)$ be a subfunctor, the set
\begin{center}
$S = \bigcup \limits_{A \in \operatorname{Hom}(\mathcal{C})} \{ f : A \to C \: | \: f \in {\bf Q}A \}$
\end{center}
is a sieve on $C$. Conversly, let $S$ be a sieve on $C$, then
\begin{center}
${\bf Q}A = \{ f : A \to C \: | \: f \in S \} \subseteq \operatorname{Hom}_{\mathcal{C}}(A, C)$
\end{center}
yields a functor ${\bf Q} : \mathcal{C}^{op} \Rightarrow {\bf Set}$ which is a subfunctor of $\operatorname{Hom}_{\mathcal{C}}(\underline{\:\:\:}, C)$.
That is, we have a bijection between sieves on $C$ and subfunctors of $\operatorname{Hom}_{\mathcal{C}}(\underline{\:\:\:}, C)$.

Moreover, let $g : B \to C$ be an arrow and let ${\bf Q}$ be a subobject of $\operatorname{Hom}_{\mathcal{C}}(\underline{\:\:\:}, C)$, then ${\bf Q}$ determines a subobject of $\operatorname{Hom}_{\mathcal{C}}(\underline{\:\:\:}, B)$ by pullback. Similarly, each sieve $S$ on $C$ determines the sieve on $B$ of the following form:
\begin{center}
$S \cdot g = \{ h \: | \: g \circ h \in S \}$
\end{center}

Thus, the subobject classifier for the presheaf category $\widehat{C}$ is defined on objects as
\begin{center}
$\Omega(C) = \{ S \: | \: \text{$S$ is a sieve on $C$ in $\mathcal{C}$}\}$
\end{center}
and on arrows by $g : C' \to C$
\begin{center}
$(\underline{\:\:}) \cdot g : \Omega(C) \rightarrow \Omega(C')$

$S \cdot g = \{ h \: | \: g \circ h \in S \}$
\end{center}

Maximal sieves defined as $t(C)$ below patch together to give a natural transformation $\top : {\bf 1} \Rightarrow \Omega$. Consider a subfunctor ${\bf Q}$ of a functor ${\bf P} : \mathcal{C}^{op} \Rightarrow {\bf Set}$, then a morphism $f : A \to C$ in $\mathcal{C}$ determines a function ${\bf F} f : {\bf F} C \to {\bf F} A$. Let $x \in {\bf F} C$ define
\begin{center}
$\phi_C(x) = \{ f \: | \: x \cdot f \in {\bf Q}(dom(f))\}$
\end{center}
where $f$ ranges over all morphisms with codomain $C$. Then $\phi_C(x)$ is a sieve on $C$ and $\phi : {\bf P} \Rightarrow \Omega$ is natural. Moreover, $\phi_C(x)$ is the maximal sieve $t(C)$ iff $x \in {\bf Q}(C)$, so we have the pullback

\centerline{
\xymatrix{
{\bf Q} \ar[r] \ar[d] & {\bf 1} \ar[d]^{\top} \\
{\bf P} \ar[r]_{\phi} & \Omega
}
}
So the natural transformation $\phi$ is the characteristic map of the subfunctor ${\bf Q}$.

\subsection{Lawvere-Tierney topology on a presheaf topos}

We consider a particular example of a Lawvere-Tierney topology for a topos ${\bf Set}^{\mathcal{O}(\mathcal{X})^{op}}$ for a topological space $\mathcal{X}$. In such a topos, the subobject classifier is a functor mapping each open set $U$ into $\Omega(U)$ of all sieves $S$ on $U$, where a sieve is a downward closed (in terms of inclusion) set of open subsets of $U$. Each open subset $V \subseteq U$ defines the principal sieve $\hat{V} = \{ W \: | \: W \subseteq V \}$. $\top_U : {\bf 1} \to \Omega(U)$ is the map that picks out the maximal sieve $\hat{U}$. Define ${\bf J}$ by

\begin{center}
${\bf J}(U) = \{ S \: | \: \text{$S$ is a sieve on $U$ and $S$ covers $S$ covers $U$ }\}$
\end{center}

Let $W \subseteq U$, the intersection $W \cap S = \{ V \cap W \: | \: V \in S \}$ covers $W$ whenever $S$ covers $U$, so ${\bf J}$ is a subfunctor of $\Omega$. The classifying function $j : \Omega \to \Omega$ is given by
\begin{center}
$j_U(S) = \{ W \in \mathcal{O}(\mathcal{X}) \: | \: W \subseteq U, \text{$S \cap W$ covers $W$}\} = \hat{V}$
\end{center}
where
\begin{center}
$V = \bigcup \limits_{W \in S} W$
\end{center}
so $j_U(S)$ specifies the largest subset of $U$ covered by $S$.

\begin{lemma}
$j : \Omega \to \Omega$ is a Lawvere-Tierney topology.
\end{lemma}

\begin{proof}
TODO
\end{proof}

\begin{theorem}
Let $\mathcal{C}$ be a small category and $J$ a Grothendieck topology on $\mathcal{C}$, then $J$ determines a Lawvere-Tierney topology $j$ on the presheaf topos ${\bf Set}^{\mathcal{C}^{op}}$.
\end{theorem}

\begin{proof}
TODO
\end{proof}

\subsection{Examples}

We start with some examples of a site.

Let $\mathcal{T}$ be a small category of topological spaces closed under finite limits and under taking open subspaces. Define $\operatorname{Cov}$ as:
\begin{center}
$\{ f_i : Y_i \to X \: | \: i \in I \}$ iff each $Y_i$ is an open subspace of $X$ and $\bigcup \limits_{i \in I} Y_i = X$
\end{center}

The first axiom holds obviously, the second axiom holds since $\mathcal{T}$ is closed under taking subspaces. The third axiom holds because of the closure under finite limits.

Let $H$ be a frame. One can define a pretopology on a frame by putting:
\begin{center}
$\{ a_i \: | \: i \in I \} \in \operatorname{Cov}(c)$ iff $c = \bigvee \limits_{i \in I} a_i$
\end{center}

\subsubsection{The Zariski site}

Let $f_1, \dots, f_m \in \mathbb{C}[x_1, \dots, x_n]$, the locus of $f_1, \dots, f_m$ is the set
\begin{center}
$V(f_1, \dots, f_m) = \{ (z_1, \dots, z_n) \in C^n \: | \: f_i(z_1, \dots, z_n) = 0, i = 1, \dots, m \}$
\end{center}
Such a locus is called a \emph{complex affine variety}. With every variety $V$ we can associate the following ideal in the polynomial ring $\mathbb{C}[x_1, \dots, x_n]$:
\begin{center}
$I_V = \{ f \in \mathbb{C}[x_1, \dots, x_n] \: | \: \forall \vec{z} \in V f(\vec{z}) = 0 \}$
\end{center}
Conversly, let $I$ be an ideal in the polynomial ring $\mathbb{C}[x_1, \dots, x_n]$, then we can define the variety
\begin{center}
$V_I = \{ (z_1, \dots, z_n) \in C^n \: | \: f(z_1, \dots, z_n) = 0, f \in I \} $
\end{center}
If $I = (f_1, \dots, f_m)$, then $V_I = V(f_1, \dots, f_m)$.

With every ideal $I$ we can associate its radical
\begin{center}
$\sqrt{I} = \bigcup \limits_{0 < r < \omega} \{ f \in \mathbb{C}[x_1, \dots, x_n] \: | \: f^r \in I \}$
\end{center}
According to the Hilbert Nullstellensatz, $V_J \neq V_I$ whenever $\sqrt{I} \neq \sqrt{J}$.

The maximal ideals in $\mathbb{C}[x_1, \dots, x_n]$ have the form $(x_1 - a_1, \dots, x_n - a_n)$, so the corresponding variety is merely the singleton $\{ (a_1, \dots, a_n) \}$, a minimal algebraic variety. A prime ideal $P$ (that is, $fg \in P$ implies $g \in P$) in $\mathbb{C}[x_1, \dots, x_n]$ is a radical ideal. The corresponding variety of $P$ is irreducible, that is, it cannot be represented as the union of a finite number of smaller ideals. Moreover, every radical ideal can be represented as the intersection of some finite number of prime ideals. Dually, every complex affine variety can be represented as the union of some finite number of irreducible varieties.

The \emph{Zariski topology} on $\mathbb{C}^n$ is a topology defined on irreducible varieties as a closed subbasis. An algebraic hypersufrace is the locus of a single polynomial $f(x_1, \dots, x_n) = 0$. The complements of hypersurfaces form the open subbasis for the Zariski topology. An example of a cover of $\mathbb{C}^n$ can be defined by $t$ polynomials $f_1, \dots, f_t \in \mathbb{C}[x_1, \dots, x_n]$ such that $f_1 + \dots + f_t = 1$. Their hypersurfaces have no common points, so their complements are an open cover of $\mathbb{C}^n$.

With the Zariski topology, we can associate a \emph{structure sheaf}. Consider a field $\mathbb{F} = \mathbb{C}(x_1, \dots, x_n)$ consisting of rational functions, where $g \neq 0$. A rational function $h$ is defined at $Q \in (a_1, \dots, a_n) \in \mathbb{C}^n$, whenever there is a Zariski open set $W$, an open neighbourhood of $Q$, such that $h$ has the form $f/g$ for some $f, g \in \mathbb{C}[x_1, \dots, x_n]$ such that $g(\vec{z}) \neq 0$ for all $\vec{z} \in W$. In other words, $h$ yields a function $W \to \mathbb{C}$.

Now let $U$ be an open set in the Zariski topology, define $\mathcal{O}(U)$ as
\begin{center}
$\mathcal{O}(U) = \{ h \in \mathbb{F} \: | \: \forall Q \in U \: \text{$h(Q)$ is defined} \}$
\end{center}
The set $\mathcal{O}(U)$ is a ring, a moreover, a subring of a field $\mathbb{F}$ whenever $U$ is non-empty. $\mathcal{O}$ is also a contravariant functor (if we consider the Zariski topology on $\mathbb{C}$ as a category). Given $U \subseteq U'$, then $\mathcal{O}(U') \to \mathcal{O}(U)$ is a ring homomorphism that restricts each $h \in \mathcal{O}(U')$ to points of $U$. That is, $\mathcal{O}$ is a presheaf of rings for the Zariski topology on $\mathbb{C}^n$. It is also can be showed that $\mathcal{O}$ is a sheaf.

The stalk of $\mathcal{O}$ at a point $p \in \mathbb{C}^n$ consists of germs of all those rational functions defined in some open neighbourhood of $p$. Such a stalk is a ring with a unique maximal proper ideal, the ideal of all those germs that vanish at $p$. A \emph{local ring} is a ring of such form.

More generally, we consider the category of all affine varieties of $V \subseteq \mathbb{C}^n$ (for various $n \geq 0$), where morphisms $\phi : V \to W$ are defined as follows. Clearly $V = V(I)$ and $W = V(I')$ for some ideals $I$ and $I'$. $\phi$ is a function defined by an $m$-tuple $\phi = (h_1, \dots, h_m)$ of rational functions of $x_1, \dots, x_n$ such that each $h_i$ is defined at every point of $V$ and $(h_1, \dots, h_m)$ as a function $V \to \mathbb{C}^m$ maps $V$ into $W$.

This category can be equipped with the open cover topology, which is the Grothedieck topology defined by covering families of Zariski open sets.

This construction can be generalised as the Zariski site over a commutative ring $K$.

Let $K$ be a commutative ring with unit, define a ring $K[a^{-1}]$ of quotients for $a \in K$ that extends $K$ with fractions $b/a^n$ for each $b \in K$ and $n < \omega$.

As above, one can define the $n$-dimensional affine space $K^n$. Let $I$ be an ideal in the polynomial ring $K[x_1, \dots, x_n]$, we can define the variety $V_I$ defined similarly to the complex case. Generally, the Nullstellensatz is not the case for an abstract $K[x_1, \dots, x_n]$, so we shall work with quotient rings $K[x_1, \dots, x_n]/I$. Let $f_1, \dots, f_m \in K[x_1, \dots, x_n]$, the \emph{finitely presented $K$-algebra} is the quotient ring $K[x_1, \dots, x_n]/(f_1, \dots, f_m)$. $(K - Alg)_{fp}$ is the category all finitely presented $K$-algebra. There is a contravariant adjointness between $(K - Alg)_{fp}$ and the corresponding varieties.

\subsubsection{Sheaves of rings on a locale}

This example is an example of both sheaves and quantales.

Let $\mathcal{L}$ be a frame and $\mathcal{O} : L \to {\bf Ring}$ a sheaf of rings on $\mathcal{L}$. We show that $\operatorname{Idl}(\mathcal{O})$, a sheaf of ideals of $\mathcal{O}$ is a quantale.

A presheaf $I$ on $\mathcal{L}$ is a \emph{presheaf of ideals} of $\mathcal{O}$ if for all $a \in \mathcal{L}$
$I(a)$ is an ideal $\mathcal{O}(a)$. If $I$ is a sheaf, then $I$ is a sheaf of ideals, or ideal of $\mathcal{O}$. The set $\operatorname{Idl}(\mathcal{O})$ is the set of all ideals of $\mathcal{O}$.

Let $I$ be a presheaf of ideals of $\mathcal{O}$, then the \emph{sheafification} $\langle I \rangle$ of $I$ is defined as, for all $a \in L$:
\begin{center}
$r \in \langle I \rangle(a)$ iff there exists a cover $\{ a_i \}_{i \in I}$ of $L$ with $r|a_i$ for all $i \in I$
\end{center}

$\langle I \rangle$ can be also defined explicitly as:
\begin{center}
$\langle I \rangle = \bigcap \{ J \in \operatorname{Idl}(\mathcal{O}) \: | \: I \subseteq J \}$
\end{center}

Consider a family $\{ I_j \}_{j \in J}$ of ideals where each $I_j \in \operatorname{Idl}(\mathcal{O})$, then the assignment $a \mapsto \sum \limits_{j \in J} I_j(a)$ is a presheaf, but it does not have to be a sheaf, but supremum in the lattice $\operatorname{Idl}(\mathcal{O})$ is defined as $\langle \sum \limits_{j \in J} I_j \rangle$.

Now we define an example of such a sheaf from the Zariski space, the dual space of a commutative ring.

TODO: complete this subsection

\section{Kripke-Joyal semantics and quantifiers via adjoint functors}

\subsection{Intuitionistic case}
\subsection{Topos version}
\subsubsection{Sheaf semantics}

\subsection{Non-commutative case}

\bibliographystyle{alpha}
\bibliography{Text}

\end{document}
